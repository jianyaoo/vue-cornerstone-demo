{"ast":null,"code":"import { StackViewport, VolumeViewport, eventTarget, EVENTS, utilities as csUtils, getEnabledElement, VideoViewport } from '@cornerstonejs/core';\nexport default function scroll(viewport, options) {\n  const enabledElement = getEnabledElement(viewport.element);\n  if (!enabledElement) {\n    throw new Error('Scroll::Viewport is not enabled (it might be disabled)');\n  }\n  if (viewport instanceof StackViewport && viewport.getImageIds().length === 0) {\n    throw new Error('Scroll::Stack Viewport has no images');\n  }\n  const {\n    type: viewportType\n  } = viewport;\n  const {\n    volumeId,\n    delta,\n    scrollSlabs\n  } = options;\n  if (viewport instanceof StackViewport) {\n    viewport.scroll(delta, options.debounceLoading, options.loop);\n  } else if (viewport instanceof VolumeViewport) {\n    scrollVolume(viewport, volumeId, delta, scrollSlabs);\n  } else if (viewport instanceof VideoViewport) {\n    viewport.scroll(delta);\n  } else {\n    throw new Error(`Not implemented for Viewport Type: ${viewportType}`);\n  }\n}\nexport function scrollVolume(viewport, volumeId, delta, scrollSlabs = false) {\n  const useSlabThickness = scrollSlabs;\n  const {\n    numScrollSteps,\n    currentStepIndex,\n    sliceRangeInfo\n  } = csUtils.getVolumeViewportScrollInfo(viewport, volumeId, useSlabThickness);\n  if (!sliceRangeInfo) {\n    return;\n  }\n  const {\n    sliceRange,\n    spacingInNormalDirection,\n    camera\n  } = sliceRangeInfo;\n  const {\n    focalPoint,\n    viewPlaneNormal,\n    position\n  } = camera;\n  const {\n    newFocalPoint,\n    newPosition\n  } = csUtils.snapFocalPointToSlice(focalPoint, position, sliceRange, viewPlaneNormal, spacingInNormalDirection, delta);\n  viewport.setCamera({\n    focalPoint: newFocalPoint,\n    position: newPosition\n  });\n  viewport.render();\n  const desiredStepIndex = currentStepIndex + delta;\n  if ((desiredStepIndex > numScrollSteps || desiredStepIndex < 0) && viewport.getCurrentImageId()) {\n    const VolumeScrollEventDetail = {\n      volumeId,\n      viewport,\n      delta,\n      desiredStepIndex,\n      currentStepIndex,\n      numScrollSteps,\n      currentImageId: viewport.getCurrentImageId()\n    };\n    csUtils.triggerEvent(eventTarget, EVENTS.VOLUME_SCROLL_OUT_OF_BOUNDS, VolumeScrollEventDetail);\n  }\n}","map":{"version":3,"names":["StackViewport","VolumeViewport","eventTarget","EVENTS","utilities","csUtils","getEnabledElement","VideoViewport","scroll","viewport","options","enabledElement","element","Error","getImageIds","length","type","viewportType","volumeId","delta","scrollSlabs","debounceLoading","loop","scrollVolume","useSlabThickness","numScrollSteps","currentStepIndex","sliceRangeInfo","getVolumeViewportScrollInfo","sliceRange","spacingInNormalDirection","camera","focalPoint","viewPlaneNormal","position","newFocalPoint","newPosition","snapFocalPointToSlice","setCamera","render","desiredStepIndex","getCurrentImageId","VolumeScrollEventDetail","currentImageId","triggerEvent","VOLUME_SCROLL_OUT_OF_BOUNDS"],"sources":["../../../src/utilities/scroll.ts"],"sourcesContent":[null],"mappings":"AAAA,SACEA,aAAa,EAEbC,cAAc,EACdC,WAAW,EACXC,MAAM,EACNC,SAAS,IAAIC,OAAO,EACpBC,iBAAiB,EACjBC,aAAa,QACR,qBAAqB;AAY5B,eAAc,SAAUC,MAAMA,CAC5BC,QAAyB,EACzBC,OAAsB;EAGtB,MAAMC,cAAc,GAAGL,iBAAiB,CAACG,QAAQ,CAACG,OAAO,CAAC;EAE1D,IAAI,CAACD,cAAc,EAAE;IACnB,MAAM,IAAIE,KAAK,CAAC,wDAAwD,CAAC;;EAG3E,IACEJ,QAAQ,YAAYT,aAAa,IACjCS,QAAQ,CAACK,WAAW,EAAE,CAACC,MAAM,KAAK,CAAC,EACnC;IACA,MAAM,IAAIF,KAAK,CAAC,sCAAsC,CAAC;;EAGzD,MAAM;IAAEG,IAAI,EAAEC;EAAY,CAAE,GAAGR,QAAQ;EACvC,MAAM;IAAES,QAAQ;IAAEC,KAAK;IAAEC;EAAW,CAAE,GAAGV,OAAO;EAEhD,IAAID,QAAQ,YAAYT,aAAa,EAAE;IACrCS,QAAQ,CAACD,MAAM,CAACW,KAAK,EAAET,OAAO,CAACW,eAAe,EAAEX,OAAO,CAACY,IAAI,CAAC;GAC9D,MAAM,IAAIb,QAAQ,YAAYR,cAAc,EAAE;IAC7CsB,YAAY,CAACd,QAAQ,EAAES,QAAQ,EAAEC,KAAK,EAAEC,WAAW,CAAC;GACrD,MAAM,IAAIX,QAAQ,YAAYF,aAAa,EAAE;IAC5CE,QAAQ,CAACD,MAAM,CAACW,KAAK,CAAC;GACvB,MAAM;IACL,MAAM,IAAIN,KAAK,CAAC,sCAAsCI,YAAY,EAAE,CAAC;;AAEzE;AAEA,OAAM,SAAUM,YAAYA,CAC1Bd,QAAwB,EACxBS,QAAgB,EAChBC,KAAa,EACbC,WAAW,GAAG,KAAK;EAEnB,MAAMI,gBAAgB,GAAGJ,WAAW;EAEpC,MAAM;IAAEK,cAAc;IAAEC,gBAAgB;IAAEC;EAAc,CAAE,GACxDtB,OAAO,CAACuB,2BAA2B,CAACnB,QAAQ,EAAES,QAAQ,EAAEM,gBAAgB,CAAC;EAE3E,IAAI,CAACG,cAAc,EAAE;IACnB;;EAGF,MAAM;IAAEE,UAAU;IAAEC,wBAAwB;IAAEC;EAAM,CAAE,GAAGJ,cAAc;EACvE,MAAM;IAAEK,UAAU;IAAEC,eAAe;IAAEC;EAAQ,CAAE,GAAGH,MAAM;EAExD,MAAM;IAAEI,aAAa;IAAEC;EAAW,CAAE,GAAG/B,OAAO,CAACgC,qBAAqB,CAClEL,UAAU,EACVE,QAAQ,EACRL,UAAU,EACVI,eAAe,EACfH,wBAAwB,EACxBX,KAAK,CACN;EAEDV,QAAQ,CAAC6B,SAAS,CAAC;IACjBN,UAAU,EAAEG,aAAa;IACzBD,QAAQ,EAAEE;GACX,CAAC;EACF3B,QAAQ,CAAC8B,MAAM,EAAE;EAEjB,MAAMC,gBAAgB,GAAGd,gBAAgB,GAAGP,KAAK;EAEjD,IACE,CAACqB,gBAAgB,GAAGf,cAAc,IAAIe,gBAAgB,GAAG,CAAC,KAC1D/B,QAAQ,CAACgC,iBAAiB,EAAE,EAC5B;IAIA,MAAMC,uBAAuB,GAAG;MAC9BxB,QAAQ;MACRT,QAAQ;MACRU,KAAK;MACLqB,gBAAgB;MAChBd,gBAAgB;MAChBD,cAAc;MACdkB,cAAc,EAAElC,QAAQ,CAACgC,iBAAiB;KAC3C;IAEDpC,OAAO,CAACuC,YAAY,CAClB1C,WAAW,EACXC,MAAM,CAAC0C,2BAA2B,EAClCH,uBAAwE,CACzE;;AAEL"},"metadata":{},"sourceType":"module","externalDependencies":[]}