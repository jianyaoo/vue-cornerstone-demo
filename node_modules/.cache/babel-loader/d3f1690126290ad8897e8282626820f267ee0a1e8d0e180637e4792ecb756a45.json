{"ast":null,"code":"import { Events } from '../../enums';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils, StackViewport } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { drawHandle as drawHandleSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg } from '../../drawingSvg';\nimport { state } from '../../store';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { roundNumber } from '../../utilities';\nimport { distanceToPoint } from '../../utilities/math/point';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor } from '../../cursors/elementCursor';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nconst {\n  transformWorldToIndex\n} = csUtils;\nclass UltrasoundDirectionalTool extends AnnotationTool {\n  constructor(toolProps = {}, defaultToolProps = {\n    supportedInteractionTypes: ['Mouse', 'Touch'],\n    configuration: {\n      shadow: true,\n      preventHandleOutsideImage: false,\n      getTextLines: defaultGetTextLines,\n      displayBothAxesDistances: false\n    }\n  }) {\n    super(toolProps, defaultToolProps);\n    this.addNewAnnotation = evt => {\n      if (this.startedDrawing) {\n        return;\n      }\n      this.startedDrawing = true;\n      const eventDetail = evt.detail;\n      const {\n        currentPoints,\n        element\n      } = eventDetail;\n      const worldPos = currentPoints.world;\n      const enabledElement = getEnabledElement(element);\n      const {\n        viewport,\n        renderingEngine\n      } = enabledElement;\n      if (!(viewport instanceof StackViewport)) {\n        throw new Error('UltrasoundDirectionalTool can only be used on a StackViewport');\n      }\n      hideElementCursor(element);\n      this.isDrawing = true;\n      const camera = viewport.getCamera();\n      const {\n        viewPlaneNormal,\n        viewUp\n      } = camera;\n      const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n      const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n      const annotation = {\n        highlighted: true,\n        invalidated: true,\n        metadata: {\n          toolName: this.getToolName(),\n          viewPlaneNormal: [...viewPlaneNormal],\n          viewUp: [...viewUp],\n          FrameOfReferenceUID,\n          referencedImageId\n        },\n        data: {\n          handles: {\n            points: [[...worldPos], [...worldPos]],\n            activeHandleIndex: null,\n            textBox: {\n              hasMoved: false,\n              worldPosition: [0, 0, 0],\n              worldBoundingBox: {\n                topLeft: [0, 0, 0],\n                topRight: [0, 0, 0],\n                bottomLeft: [0, 0, 0],\n                bottomRight: [0, 0, 0]\n              }\n            }\n          },\n          label: '',\n          cachedStats: {}\n        }\n      };\n      addAnnotation(annotation, element);\n      const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n      this.editData = {\n        annotation,\n        viewportIdsToRender,\n        handleIndex: 1,\n        movingTextBox: false,\n        newAnnotation: true,\n        hasMoved: false\n      };\n      this._activateDraw(element);\n      evt.preventDefault();\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      return annotation;\n    };\n    this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n      return false;\n    };\n    this._endCallback = evt => {\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        newAnnotation,\n        hasMoved\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (newAnnotation && !hasMoved) {\n        return;\n      }\n      if (this.startedDrawing && data.handles.points.length === 1) {\n        this.editData.handleIndex = 1;\n        return;\n      }\n      this.startedDrawing = false;\n      data.handles.activeHandleIndex = null;\n      this._deactivateModify(element);\n      this._deactivateDraw(element);\n      resetElementCursor(element);\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      if (this.isHandleOutsideImage && this.configuration.preventHandleOutsideImage) {\n        removeAnnotation(annotation.annotationUID);\n      }\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      if (newAnnotation) {\n        const eventType = Events.ANNOTATION_COMPLETED;\n        const eventDetail = {\n          annotation\n        };\n        triggerEvent(eventTarget, eventType, eventDetail);\n      }\n      this.editData = null;\n      this.isDrawing = false;\n    };\n    this._dragCallback = evt => {\n      this.isDrawing = true;\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        handleIndex,\n        movingTextBox\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (movingTextBox) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const {\n          textBox\n        } = data.handles;\n        const {\n          worldPosition\n        } = textBox;\n        worldPosition[0] += worldPosDelta[0];\n        worldPosition[1] += worldPosDelta[1];\n        worldPosition[2] += worldPosDelta[2];\n        textBox.hasMoved = true;\n      } else if (handleIndex === undefined) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const points = data.handles.points;\n        points.forEach(point => {\n          point[0] += worldPosDelta[0];\n          point[1] += worldPosDelta[1];\n          point[2] += worldPosDelta[2];\n        });\n        annotation.invalidated = true;\n      } else {\n        const {\n          currentPoints\n        } = eventDetail;\n        const worldPos = currentPoints.world;\n        data.handles.points[handleIndex] = [...worldPos];\n        annotation.invalidated = true;\n      }\n      this.editData.hasMoved = true;\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    };\n    this.cancel = element => {\n      if (this.isDrawing) {\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const {\n          annotation,\n          viewportIdsToRender,\n          newAnnotation\n        } = this.editData;\n        const {\n          data\n        } = annotation;\n        annotation.highlighted = false;\n        data.handles.activeHandleIndex = null;\n        const enabledElement = getEnabledElement(element);\n        const {\n          renderingEngine\n        } = enabledElement;\n        triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n        if (newAnnotation) {\n          const eventType = Events.ANNOTATION_COMPLETED;\n          const eventDetail = {\n            annotation\n          };\n          triggerEvent(eventTarget, eventType, eventDetail);\n        }\n        this.editData = null;\n        this.startedDrawing = false;\n        return annotation.annotationUID;\n      }\n    };\n    this._activateModify = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._deactivateModify = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._activateDraw = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._deactivateDraw = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n      let renderStatus = false;\n      const {\n        viewport\n      } = enabledElement;\n      const {\n        element\n      } = viewport;\n      let annotations = getAnnotations(this.getToolName(), element);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      const targetId = this.getTargetId(viewport);\n      const renderingEngine = viewport.getRenderingEngine();\n      const styleSpecifier = {\n        toolGroupId: this.toolGroupId,\n        toolName: this.getToolName(),\n        viewportId: enabledElement.viewport.id\n      };\n      for (let i = 0; i < annotations.length; i++) {\n        const annotation = annotations[i];\n        const {\n          annotationUID,\n          data\n        } = annotation;\n        const {\n          points\n        } = data.handles;\n        styleSpecifier.annotationUID = annotationUID;\n        const color = this.getStyle('color', styleSpecifier, annotation);\n        const canvasCoordinates = points.map(p => viewport.worldToCanvas(p));\n        if (!data.cachedStats[targetId] || data.cachedStats[targetId].xValues == null) {\n          data.cachedStats[targetId] = {\n            xValues: [0, 0],\n            yValues: [0, 0],\n            isHorizontal: false,\n            units: [''],\n            isUnitless: false\n          };\n          this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n        } else if (annotation.invalidated) {\n          this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n        }\n        if (!viewport.getRenderingEngine()) {\n          console.warn('Rendering Engine has been destroyed');\n          return renderStatus;\n        }\n        let handleGroupUID = '0';\n        drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[0], {\n          color\n        }, 0);\n        renderStatus = true;\n        if (canvasCoordinates.length !== 2) {\n          return renderStatus;\n        }\n        handleGroupUID = '1';\n        drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[1], {\n          color\n        }, 1);\n        const isUnitless = data.cachedStats[targetId].isUnitless;\n        if (!isUnitless) {\n          const canvasPoint1 = canvasCoordinates[0];\n          const canvasPoint2 = canvasCoordinates[1];\n          const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n          const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n          const isHorizontal = data.cachedStats[targetId].isHorizontal;\n          let projectedPointCanvas = [0, 0];\n          if (isHorizontal) {\n            projectedPointCanvas = [canvasPoint1[0] + canvasDeltaX, canvasPoint1[1]];\n          } else {\n            projectedPointCanvas = [canvasPoint1[0], canvasPoint1[1] + canvasDeltaY];\n          }\n          let dataId = `${annotationUID}-line-1`;\n          let lineUID = '1';\n          drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], projectedPointCanvas, {\n            color,\n            width: 1,\n            shadow: this.configuration.shadow\n          }, dataId);\n          dataId = `${annotationUID}-line-2`;\n          lineUID = '2';\n          drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], projectedPointCanvas, {\n            color,\n            width: 1,\n            lineDash: [1, 1],\n            shadow: this.configuration.shadow\n          }, dataId);\n        } else {\n          const dataId = `${annotationUID}-line-1`;\n          const lineUID = '1';\n          drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n            color,\n            width: 1,\n            shadow: this.configuration.shadow\n          }, dataId);\n        }\n        const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n        if (!options.visibility) {\n          data.handles.textBox = {\n            hasMoved: false,\n            worldPosition: [0, 0, 0],\n            worldBoundingBox: {\n              topLeft: [0, 0, 0],\n              topRight: [0, 0, 0],\n              bottomLeft: [0, 0, 0],\n              bottomRight: [0, 0, 0]\n            }\n          };\n          continue;\n        }\n        const textLines = this.configuration.getTextLines(data, targetId, this.configuration);\n        if (!data.handles.textBox.hasMoved) {\n          const canvasTextBoxCoords = canvasCoordinates[1];\n          data.handles.textBox.worldPosition = viewport.canvasToWorld(canvasTextBoxCoords);\n        }\n        const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n        const textBoxUID = '1';\n        const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n        const {\n          x: left,\n          y: top,\n          width,\n          height\n        } = boundingBox;\n        data.handles.textBox.worldBoundingBox = {\n          topLeft: viewport.canvasToWorld([left, top]),\n          topRight: viewport.canvasToWorld([left + width, top]),\n          bottomLeft: viewport.canvasToWorld([left, top + height]),\n          bottomRight: viewport.canvasToWorld([left + width, top + height])\n        };\n      }\n      return renderStatus;\n    };\n    this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, {\n      trailing: true\n    });\n  }\n  toolSelectedCallback(evt, annotation, interactionType, canvasCoords) {\n    return;\n  }\n  handleSelectedCallback(evt, annotation, handle) {\n    const eventDetail = evt.detail;\n    const {\n      element\n    } = eventDetail;\n    const {\n      data\n    } = annotation;\n    annotation.highlighted = true;\n    const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n    let movingTextBox = false;\n    let handleIndex;\n    if (handle.worldPosition) {\n      movingTextBox = true;\n    } else {\n      handleIndex = data.handles.points.findIndex(p => p === handle);\n    }\n    this.editData = {\n      handleIndex,\n      annotation,\n      viewportIdsToRender\n    };\n    this._activateModify(element);\n    hideElementCursor(element);\n    const enabledElement = getEnabledElement(element);\n    const {\n      renderingEngine\n    } = enabledElement;\n    triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    evt.preventDefault();\n  }\n  _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n    const data = annotation.data;\n    const {\n      viewportId,\n      renderingEngineId\n    } = enabledElement;\n    if (data.handles.points.length !== 2) {\n      return;\n    }\n    const {\n      cachedStats\n    } = data;\n    const targetIds = Object.keys(cachedStats);\n    for (let i = 0; i < targetIds.length; i++) {\n      const targetId = targetIds[i];\n      const image = this.getTargetIdImage(targetId, renderingEngine);\n      if (!image) {\n        continue;\n      }\n      const {\n        imageData\n      } = image;\n      const worldPos1 = data.handles.points[0];\n      const worldPos2 = data.handles.points[1];\n      const imageIndex1 = transformWorldToIndex(imageData, worldPos1);\n      const imageIndex2 = transformWorldToIndex(imageData, worldPos2);\n      const {\n        values: values1,\n        units: units1\n      } = getCalibratedProbeUnitsAndValue(image, [imageIndex1]);\n      const {\n        values: values2,\n        units: units2\n      } = getCalibratedProbeUnitsAndValue(image, [imageIndex2]);\n      let xValues, yValues, units, isHorizontal;\n      let isUnitless = false;\n      if (units1[0] !== units2[0] || units1[1] !== units2[1] || units1[0] === 'raw' && units2[0] === 'raw') {\n        const value = distanceToPoint(worldPos1, worldPos2);\n        xValues = [value, 0];\n        yValues = [value, 0];\n        units = ['px'];\n        isUnitless = true;\n      } else {\n        const canvasPoint1 = enabledElement.viewport.worldToCanvas(worldPos1);\n        const canvasPoint2 = enabledElement.viewport.worldToCanvas(worldPos2);\n        const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n        const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n        isHorizontal = Math.abs(canvasDeltaX) > Math.abs(canvasDeltaY);\n        xValues = [values1[0], values2[0]];\n        yValues = [values1[1], values2[1]];\n        units = [units1[0], units1[1]];\n      }\n      cachedStats[targetId] = {\n        xValues,\n        yValues,\n        isHorizontal,\n        units,\n        isUnitless\n      };\n    }\n    annotation.invalidated = false;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n      annotation,\n      viewportId,\n      renderingEngineId\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n    return cachedStats;\n  }\n}\nfunction defaultGetTextLines(data, targetId, configuration) {\n  const cachedStats = data.cachedStats[targetId];\n  const {\n    xValues,\n    yValues,\n    units,\n    isUnitless,\n    isHorizontal\n  } = cachedStats;\n  if (isUnitless) {\n    return [`${roundNumber(xValues[0])} px`];\n  }\n  if (configuration.displayBothAxesDistances) {\n    const dist1 = Math.abs(xValues[1] - xValues[0]);\n    const dist2 = Math.abs(yValues[1] - yValues[0]);\n    return [`${roundNumber(dist1)} ${units[0]}`, `${roundNumber(dist2)} ${units[1]}`];\n  }\n  if (isHorizontal) {\n    const dist = Math.abs(xValues[1] - xValues[0]);\n    return [`${roundNumber(dist)} ${units[0]}`];\n  } else {\n    const dist = Math.abs(yValues[1] - yValues[0]);\n    return [`${roundNumber(dist)} ${units[1]}`];\n  }\n}\nUltrasoundDirectionalTool.toolName = 'UltrasoundDirectionalTool';\nexport default UltrasoundDirectionalTool;","map":{"version":3,"names":["Events","getEnabledElement","triggerEvent","eventTarget","utilities","csUtils","StackViewport","AnnotationTool","throttle","addAnnotation","getAnnotations","removeAnnotation","drawHandle","drawHandleSvg","drawLine","drawLineSvg","drawLinkedTextBox","drawLinkedTextBoxSvg","state","getViewportIdsWithToolToRender","roundNumber","distanceToPoint","triggerAnnotationRenderForViewportIds","resetElementCursor","hideElementCursor","getCalibratedProbeUnitsAndValue","transformWorldToIndex","UltrasoundDirectionalTool","constructor","toolProps","defaultToolProps","supportedInteractionTypes","configuration","shadow","preventHandleOutsideImage","getTextLines","defaultGetTextLines","displayBothAxesDistances","addNewAnnotation","evt","startedDrawing","eventDetail","detail","currentPoints","element","worldPos","world","enabledElement","viewport","renderingEngine","Error","isDrawing","camera","getCamera","viewPlaneNormal","viewUp","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getFrameOfReferenceUID","annotation","highlighted","invalidated","metadata","toolName","getToolName","data","handles","points","activeHandleIndex","textBox","hasMoved","worldPosition","worldBoundingBox","topLeft","topRight","bottomLeft","bottomRight","label","cachedStats","viewportIdsToRender","editData","handleIndex","movingTextBox","newAnnotation","_activateDraw","preventDefault","isPointNearTool","canvasCoords","proximity","_endCallback","length","_deactivateModify","_deactivateDraw","isHandleOutsideImage","annotationUID","eventType","ANNOTATION_COMPLETED","_dragCallback","deltaPoints","worldPosDelta","undefined","forEach","point","cancel","_activateModify","isInteractingWithTool","addEventListener","MOUSE_UP","MOUSE_DRAG","MOUSE_CLICK","TOUCH_TAP","TOUCH_END","TOUCH_DRAG","removeEventListener","MOUSE_MOVE","renderAnnotation","svgDrawingHelper","renderStatus","annotations","filterInteractableAnnotationsForElement","targetId","getTargetId","getRenderingEngine","styleSpecifier","toolGroupId","viewportId","id","i","color","getStyle","canvasCoordinates","map","p","worldToCanvas","xValues","yValues","isHorizontal","units","isUnitless","_calculateCachedStats","_throttledCalculateCachedStats","console","warn","handleGroupUID","canvasPoint1","canvasPoint2","canvasDeltaY","canvasDeltaX","projectedPointCanvas","dataId","lineUID","width","lineDash","options","getLinkedTextBoxStyle","visibility","textLines","canvasTextBoxCoords","canvasToWorld","textBoxPosition","textBoxUID","boundingBox","x","left","y","top","height","trailing","toolSelectedCallback","interactionType","handleSelectedCallback","handle","findIndex","renderingEngineId","targetIds","Object","keys","image","getTargetIdImage","imageData","worldPos1","worldPos2","imageIndex1","imageIndex2","values","values1","units1","values2","units2","value","Math","abs","ANNOTATION_MODIFIED","dist1","dist2","dist"],"sources":["../../../../src/tools/annotation/UltrasoundDirectionalTool.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}