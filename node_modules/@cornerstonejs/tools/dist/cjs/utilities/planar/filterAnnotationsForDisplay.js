"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@cornerstonejs/core");
const filterAnnotationsWithinSlice_1 = __importDefault(require("./filterAnnotationsWithinSlice"));
function filterAnnotationsForDisplay(viewport, annotations, filterOptions = {}) {
    if (viewport instanceof core_1.VolumeViewport) {
        const camera = viewport.getCamera();
        const { spacingInNormalDirection } = core_1.utilities.getTargetVolumeAndSpacingInNormalDir(viewport, camera);
        return (0, filterAnnotationsWithinSlice_1.default)(annotations, camera, spacingInNormalDirection);
    }
    if (viewport instanceof core_1.StackViewport) {
        const imageId = viewport.getCurrentImageId();
        const colonIndex = imageId.indexOf(':');
        filterOptions.imageURI = imageId.substring(colonIndex + 1);
    }
    return annotations.filter((annotation) => {
        if (!annotation.isVisible) {
            return false;
        }
        if (annotation.data.isCanvasAnnotation) {
            return true;
        }
        return viewport.isReferenceViewable(annotation.metadata, filterOptions);
    });
}
exports.default = filterAnnotationsForDisplay;
//# sourceMappingURL=filterAnnotationsForDisplay.js.map