{"ast":null,"code":"function generateLinearVOILUT(windowWidth, windowCenter) {\n  return function (modalityLutValue) {\n    const value = ((modalityLutValue - (windowCenter - 0.5)) / (windowWidth - 1) + 0.5) * 255.0;\n    return Math.min(Math.max(value, 0), 255);\n  };\n}\nfunction generateNonLinearVOILUT(voiLUT) {\n  const bitsPerEntry = Math.max(...voiLUT.lut).toString(2).length;\n  const shift = bitsPerEntry - 8;\n  const minValue = voiLUT.lut[0] >> shift;\n  const maxValue = voiLUT.lut[voiLUT.lut.length - 1] >> shift;\n  const maxValueMapped = voiLUT.firstValueMapped + voiLUT.lut.length - 1;\n  return function (modalityLutValue) {\n    if (modalityLutValue < voiLUT.firstValueMapped) {\n      return minValue;\n    } else if (modalityLutValue >= maxValueMapped) {\n      return maxValue;\n    }\n    return voiLUT.lut[modalityLutValue - voiLUT.firstValueMapped] >> shift;\n  };\n}\nexport default function (windowWidth, windowCenter, voiLUT) {\n  if (voiLUT) {\n    return generateNonLinearVOILUT(voiLUT);\n  }\n  return generateLinearVOILUT(windowWidth, windowCenter);\n}","map":{"version":3,"names":["generateLinearVOILUT","windowWidth","windowCenter","modalityLutValue","value","Math","min","max","generateNonLinearVOILUT","voiLUT","bitsPerEntry","lut","toString","length","shift","minValue","maxValue","maxValueMapped","firstValueMapped"],"sources":["../../../../../../src/RenderingEngine/helpers/cpuFallback/rendering/getVOILut.ts"],"sourcesContent":[null],"mappings":"AA4BA,SAASA,oBAAoBA,CAACC,WAAmB,EAAEC,YAAoB;EACrE,OAAO,UAAUC,gBAAgB;IAC/B,MAAMC,KAAK,GACT,CAAC,CAACD,gBAAgB,IAAID,YAAY,GAAG,GAAG,CAAC,KAAKD,WAAW,GAAG,CAAC,CAAC,GAAG,GAAG,IACpE,KAAK;IACP,OAAOI,IAAI,CAACC,GAAG,CAACD,IAAI,CAACE,GAAG,CAACH,KAAK,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC;EAC1C,CAAC;AACH;AAUA,SAASI,uBAAuBA,CAACC,MAAM;EAErC,MAAMC,YAAY,GAAGL,IAAI,CAACE,GAAG,CAAC,GAAGE,MAAM,CAACE,GAAG,CAAC,CAACC,QAAQ,CAAC,CAAC,CAAC,CAACC,MAAM;EAC/D,MAAMC,KAAK,GAAGJ,YAAY,GAAG,CAAC;EAC9B,MAAMK,QAAQ,GAAGN,MAAM,CAACE,GAAG,CAAC,CAAC,CAAC,IAAIG,KAAK;EACvC,MAAME,QAAQ,GAAGP,MAAM,CAACE,GAAG,CAACF,MAAM,CAACE,GAAG,CAACE,MAAM,GAAG,CAAC,CAAC,IAAIC,KAAK;EAC3D,MAAMG,cAAc,GAAGR,MAAM,CAACS,gBAAgB,GAAGT,MAAM,CAACE,GAAG,CAACE,MAAM,GAAG,CAAC;EAEtE,OAAO,UAAUV,gBAAgB;IAC/B,IAAIA,gBAAgB,GAAGM,MAAM,CAACS,gBAAgB,EAAE;MAC9C,OAAOH,QAAQ;KAChB,MAAM,IAAIZ,gBAAgB,IAAIc,cAAc,EAAE;MAC7C,OAAOD,QAAQ;;IAGjB,OAAOP,MAAM,CAACE,GAAG,CAACR,gBAAgB,GAAGM,MAAM,CAACS,gBAAgB,CAAC,IAAIJ,KAAK;EACxE,CAAC;AACH;AAaA,eAAc,UAAWb,WAAmB,EAAEC,YAAoB,EAAEO,MAAM;EACxE,IAAIA,MAAM,EAAE;IACV,OAAOD,uBAAuB,CAACC,MAAM,CAAC;;EAGxC,OAAOT,oBAAoB,CAACC,WAAW,EAAEC,YAAY,CAAC;AACxD"},"metadata":{},"sourceType":"module","externalDependencies":[]}