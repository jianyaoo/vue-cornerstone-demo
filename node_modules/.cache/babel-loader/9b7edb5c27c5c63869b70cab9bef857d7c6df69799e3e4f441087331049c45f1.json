{"ast":null,"code":"import { utilities } from '@cornerstonejs/core';\nimport * as SegmentationConfig from './config/segmentationConfig';\nimport { addSegmentationRepresentation as addSegmentationRepresentationToState, getNextColorLUTIndex, addColorLUT } from './segmentationState';\nimport { getRepresentationSpecificConfig } from './helpers/getRepresentationSpecificConfig';\nimport CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nasync function addSegmentationRepresentation(toolGroupId, representationInput, toolGroupSpecificConfig) {\n  const {\n    segmentationId,\n    options = {}\n  } = representationInput;\n  const segmentationRepresentationUID = utilities.uuidv4();\n  const segmentsHidden = new Set();\n  const colorLUTOrIndexInput = options.colorLUTOrIndex;\n  let colorLUTIndexToUse;\n  if (typeof colorLUTOrIndexInput === 'number') {\n    colorLUTIndexToUse = colorLUTOrIndexInput;\n  } else {\n    const nextIndex = getNextColorLUTIndex();\n    const colorLUTToAdd = Array.isArray(colorLUTOrIndexInput) ? colorLUTOrIndexInput : CORNERSTONE_COLOR_LUT;\n    addColorLUT(colorLUTToAdd, nextIndex);\n    colorLUTIndexToUse = nextIndex;\n  }\n  const toolGroupSpecificRepresentation = {\n    segmentationId,\n    segmentationRepresentationUID,\n    type: representationInput.type,\n    segmentsHidden,\n    colorLUTIndex: colorLUTIndexToUse,\n    active: true,\n    segmentationRepresentationSpecificConfig: {},\n    segmentSpecificConfig: {},\n    config: getRepresentationSpecificConfig(representationInput)\n  };\n  if (toolGroupSpecificConfig) {\n    const currentToolGroupConfig = SegmentationConfig.getToolGroupSpecificConfig(toolGroupId);\n    const mergedConfig = utilities.deepMerge(currentToolGroupConfig, toolGroupSpecificConfig);\n    SegmentationConfig.setToolGroupSpecificConfig(toolGroupId, {\n      renderInactiveSegmentations: mergedConfig.renderInactiveSegmentations || true,\n      representations: {\n        ...mergedConfig.representations\n      }\n    });\n  }\n  addSegmentationRepresentationToState(toolGroupId, toolGroupSpecificRepresentation);\n  return segmentationRepresentationUID;\n}\nexport { addSegmentationRepresentation };","map":{"version":3,"names":["utilities","SegmentationConfig","addSegmentationRepresentation","addSegmentationRepresentationToState","getNextColorLUTIndex","addColorLUT","getRepresentationSpecificConfig","CORNERSTONE_COLOR_LUT","toolGroupId","representationInput","toolGroupSpecificConfig","segmentationId","options","segmentationRepresentationUID","uuidv4","segmentsHidden","Set","colorLUTOrIndexInput","colorLUTOrIndex","colorLUTIndexToUse","nextIndex","colorLUTToAdd","Array","isArray","toolGroupSpecificRepresentation","type","colorLUTIndex","active","segmentationRepresentationSpecificConfig","segmentSpecificConfig","config","currentToolGroupConfig","getToolGroupSpecificConfig","mergedConfig","deepMerge","setToolGroupSpecificConfig","renderInactiveSegmentations","representations"],"sources":["../../../../src/stateManagement/segmentation/addSegmentationRepresentation.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,SAAS,QAAQ,qBAAqB;AAO/C,OAAO,KAAKC,kBAAkB,MAAM,6BAA6B;AACjE,SACEC,6BAA6B,IAAIC,oCAAoC,EACrEC,oBAAoB,EACpBC,WAAW,QACN,qBAAqB;AAC5B,SAASC,+BAA+B,QAAQ,2CAA2C;AAC3F,OAAOC,qBAAqB,MAAM,2BAA2B;AAE7D,eAAeL,6BAA6BA,CAC1CM,WAAmB,EACnBC,mBAA8C,EAC9CC,uBAA0D;EAE1D,MAAM;IAAEC,cAAc;IAAEC,OAAO,GAAG;EAAE,CAAE,GAAGH,mBAAmB;EAC5D,MAAMI,6BAA6B,GAAGb,SAAS,CAACc,MAAM,EAAE;EAIxD,MAAMC,cAAc,GAAG,IAAIC,GAAG,EAAiB;EAE/C,MAAMC,oBAAoB,GAAGL,OAAO,CAACM,eAAe;EACpD,IAAIC,kBAAkB;EAEtB,IAAI,OAAOF,oBAAoB,KAAK,QAAQ,EAAE;IAC5CE,kBAAkB,GAAGF,oBAAoB;GAC1C,MAAM;IACL,MAAMG,SAAS,GAAGhB,oBAAoB,EAAE;IACxC,MAAMiB,aAAa,GAAGC,KAAK,CAACC,OAAO,CAACN,oBAAoB,CAAC,GACrDA,oBAAoB,GACpBV,qBAAqB;IACzBF,WAAW,CAACgB,aAA+B,EAAED,SAAS,CAAC;IACvDD,kBAAkB,GAAGC,SAAS;;EAGhC,MAAMI,+BAA+B,GAAoC;IACvEb,cAAc;IACdE,6BAA6B;IAC7BY,IAAI,EAAEhB,mBAAmB,CAACgB,IAAI;IAC9BV,cAAc;IACdW,aAAa,EAAEP,kBAAkB;IACjCQ,MAAM,EAAE,IAAI;IACZC,wCAAwC,EAAE,EAAE;IAC5CC,qBAAqB,EAAE,EAAE;IACzBC,MAAM,EAAExB,+BAA+B,CAACG,mBAAmB;GAC5D;EAGD,IAAIC,uBAAuB,EAAE;IAI3B,MAAMqB,sBAAsB,GAC1B9B,kBAAkB,CAAC+B,0BAA0B,CAACxB,WAAW,CAAC;IAE5D,MAAMyB,YAAY,GAAGjC,SAAS,CAACkC,SAAS,CACtCH,sBAAsB,EACtBrB,uBAAuB,CACxB;IAEDT,kBAAkB,CAACkC,0BAA0B,CAAC3B,WAAW,EAAE;MACzD4B,2BAA2B,EACzBH,YAAY,CAACG,2BAA2B,IAAI,IAAI;MAClDC,eAAe,EAAE;QACf,GAAGJ,YAAY,CAACI;;KAEnB,CAAC;;EAGJlC,oCAAoC,CAClCK,WAAW,EACXgB,+BAA+B,CAChC;EAED,OAAOX,6BAA6B;AACtC;AAEA,SAASX,6BAA6B"},"metadata":{},"sourceType":"module","externalDependencies":[]}