{"ast":null,"code":"import { getEnabledElement } from '@cornerstonejs/core';\nimport { state } from '../../../store';\nimport { Events } from '../../../enums';\nimport { hideElementCursor } from '../../../cursors/elementCursor';\nimport { polyline } from '../../../utilities/math';\nconst {\n  getSubPixelSpacingAndXYDirections\n} = polyline;\nfunction activateOpenContourEndEdit(evt, annotation, viewportIdsToRender, handle) {\n  this.isDrawing = true;\n  const eventDetail = evt.detail;\n  const {\n    element\n  } = eventDetail;\n  const enabledElement = getEnabledElement(element);\n  const {\n    viewport\n  } = enabledElement;\n  const {\n    spacing,\n    xDir,\n    yDir\n  } = getSubPixelSpacingAndXYDirections(viewport, this.configuration.subPixelResolution);\n  const canvasPoints = annotation.data.contour.polyline.map(viewport.worldToCanvas);\n  const handleIndexGrabbed = annotation.data.handles.activeHandleIndex;\n  if (handleIndexGrabbed === 0) {\n    canvasPoints.reverse();\n  }\n  let movingTextBox = false;\n  if (handle.worldPosition) {\n    movingTextBox = true;\n  }\n  this.drawData = {\n    canvasPoints: canvasPoints,\n    polylineIndex: canvasPoints.length - 1\n  };\n  this.commonData = {\n    annotation,\n    viewportIdsToRender,\n    spacing,\n    xDir,\n    yDir,\n    movingTextBox\n  };\n  state.isInteractingWithTool = true;\n  element.addEventListener(Events.MOUSE_UP, this.mouseUpDrawCallback);\n  element.addEventListener(Events.MOUSE_DRAG, this.mouseDragDrawCallback);\n  element.addEventListener(Events.MOUSE_CLICK, this.mouseUpDrawCallback);\n  element.addEventListener(Events.TOUCH_END, this.mouseUpDrawCallback);\n  element.addEventListener(Events.TOUCH_DRAG, this.mouseDragDrawCallback);\n  element.addEventListener(Events.TOUCH_TAP, this.mouseUpDrawCallback);\n  hideElementCursor(element);\n}\nfunction registerOpenContourEndEditLoop(toolInstance) {\n  toolInstance.activateOpenContourEndEdit = activateOpenContourEndEdit.bind(toolInstance);\n}\nexport default registerOpenContourEndEditLoop;","map":{"version":3,"names":["getEnabledElement","state","Events","hideElementCursor","polyline","getSubPixelSpacingAndXYDirections","activateOpenContourEndEdit","evt","annotation","viewportIdsToRender","handle","isDrawing","eventDetail","detail","element","enabledElement","viewport","spacing","xDir","yDir","configuration","subPixelResolution","canvasPoints","data","contour","map","worldToCanvas","handleIndexGrabbed","handles","activeHandleIndex","reverse","movingTextBox","worldPosition","drawData","polylineIndex","length","commonData","isInteractingWithTool","addEventListener","MOUSE_UP","mouseUpDrawCallback","MOUSE_DRAG","mouseDragDrawCallback","MOUSE_CLICK","TOUCH_END","TOUCH_DRAG","TOUCH_TAP","registerOpenContourEndEditLoop","toolInstance","bind"],"sources":["../../../../../src/tools/annotation/planarFreehandROITool/openContourEndEditLoop.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,iBAAiB,QAAQ,qBAAqB;AACvD,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,MAAM,QAAQ,gBAAgB;AACvC,SAASC,iBAAiB,QAAQ,gCAAgC;AAQlE,SAASC,QAAQ,QAAQ,yBAAyB;AAElD,MAAM;EAAEC;AAAiC,CAAE,GAAGD,QAAQ;AAMtD,SAASE,0BAA0BA,CACjCC,GAAoC,EACpCC,UAAuC,EACvCC,mBAA6B,EAC7BC,MAAyB;EAEzB,IAAI,CAACC,SAAS,GAAG,IAAI;EAErB,MAAMC,WAAW,GAAGL,GAAG,CAACM,MAAM;EAC9B,MAAM;IAAEC;EAAO,CAAE,GAAGF,WAAW;EAC/B,MAAMG,cAAc,GAAGf,iBAAiB,CAACc,OAAO,CAAC;EACjD,MAAM;IAAEE;EAAQ,CAAE,GAAGD,cAAc;EAEnC,MAAM;IAAEE,OAAO;IAAEC,IAAI;IAAEC;EAAI,CAAE,GAAGd,iCAAiC,CAC/DW,QAAQ,EACR,IAAI,CAACI,aAAa,CAACC,kBAAkB,CACtC;EAED,MAAMC,YAAY,GAAGd,UAAU,CAACe,IAAI,CAACC,OAAO,CAACpB,QAAQ,CAACqB,GAAG,CACvDT,QAAQ,CAACU,aAAa,CACvB;EACD,MAAMC,kBAAkB,GAAGnB,UAAU,CAACe,IAAI,CAACK,OAAO,CAACC,iBAAiB;EAIpE,IAAIF,kBAAkB,KAAK,CAAC,EAAE;IAC5BL,YAAY,CAACQ,OAAO,EAAE;;EAGxB,IAAIC,aAAa,GAAG,KAAK;EACzB,IAAKrB,MAAwB,CAACsB,aAAa,EAAE;IAC3CD,aAAa,GAAG,IAAI;;EAGtB,IAAI,CAACE,QAAQ,GAAG;IACdX,YAAY,EAAEA,YAAY;IAC1BY,aAAa,EAAEZ,YAAY,CAACa,MAAM,GAAG;GACtC;EAED,IAAI,CAACC,UAAU,GAAG;IAChB5B,UAAU;IACVC,mBAAmB;IACnBQ,OAAO;IACPC,IAAI;IACJC,IAAI;IACJY;GACD;EAED9B,KAAK,CAACoC,qBAAqB,GAAG,IAAI;EAGlCvB,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAACqC,QAAQ,EAAE,IAAI,CAACC,mBAAmB,CAAC;EACnE1B,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAACuC,UAAU,EAAE,IAAI,CAACC,qBAAqB,CAAC;EACvE5B,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAACyC,WAAW,EAAE,IAAI,CAACH,mBAAmB,CAAC;EACtE1B,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAAC0C,SAAS,EAAE,IAAI,CAACJ,mBAAmB,CAAC;EACpE1B,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAAC2C,UAAU,EAAE,IAAI,CAACH,qBAAqB,CAAC;EACvE5B,OAAO,CAACwB,gBAAgB,CAACpC,MAAM,CAAC4C,SAAS,EAAE,IAAI,CAACN,mBAAmB,CAAC;EAEpErC,iBAAiB,CAACW,OAAO,CAAC;AAC5B;AAKA,SAASiC,8BAA8BA,CAACC,YAAY;EAClDA,YAAY,CAAC1C,0BAA0B,GACrCA,0BAA0B,CAAC2C,IAAI,CAACD,YAAY,CAAC;AACjD;AAEA,eAAeD,8BAA8B"},"metadata":{},"sourceType":"module","externalDependencies":[]}