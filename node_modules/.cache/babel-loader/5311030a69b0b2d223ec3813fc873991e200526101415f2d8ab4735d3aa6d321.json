{"ast":null,"code":"import { utilities as csUtils } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport BrushStrategy from './BrushStrategy';\nimport compositions from './compositions';\nimport StrategyCallbacks from '../../../enums/StrategyCallbacks';\nimport { createEllipseInPoint } from './fillCircle';\nconst {\n  transformWorldToIndex\n} = csUtils;\nimport { getSphereBoundsInfo } from '../../../utilities/getSphereBoundsInfo';\nconst sphereComposition = {\n  [StrategyCallbacks.Initialize]: operationData => {\n    const {\n      points,\n      imageVoxelManager: imageVoxelManager,\n      viewport,\n      segmentationImageData,\n      segmentationVoxelManager: segmentationVoxelManager\n    } = operationData;\n    if (!points) {\n      return;\n    }\n    const center = vec3.fromValues(0, 0, 0);\n    points.forEach(point => {\n      vec3.add(center, center, point);\n    });\n    vec3.scale(center, center, 1 / points.length);\n    operationData.centerWorld = center;\n    operationData.centerIJK = transformWorldToIndex(segmentationImageData, center);\n    const {\n      boundsIJK: newBoundsIJK,\n      topLeftWorld,\n      bottomRightWorld\n    } = getSphereBoundsInfo(points.slice(0, 2), segmentationImageData, viewport);\n    segmentationVoxelManager.boundsIJK = newBoundsIJK;\n    imageVoxelManager.isInObject = createEllipseInPoint({\n      topLeftWorld,\n      bottomRightWorld,\n      center\n    });\n  }\n};\nconst SPHERE_STRATEGY = new BrushStrategy('Sphere', compositions.regionFill, compositions.setValue, sphereComposition, compositions.determineSegmentIndex, compositions.preview);\nconst fillInsideSphere = SPHERE_STRATEGY.strategyFunction;\nconst SPHERE_THRESHOLD_STRATEGY = new BrushStrategy('SphereThreshold', ...SPHERE_STRATEGY.compositions, compositions.dynamicThreshold, compositions.threshold, compositions.islandRemoval);\nconst thresholdInsideSphere = SPHERE_THRESHOLD_STRATEGY.strategyFunction;\nexport function fillOutsideSphere() {\n  throw new Error('fill outside sphere not implemented');\n}\nexport { fillInsideSphere, thresholdInsideSphere, SPHERE_STRATEGY };","map":{"version":3,"names":["utilities","csUtils","vec3","BrushStrategy","compositions","StrategyCallbacks","createEllipseInPoint","transformWorldToIndex","getSphereBoundsInfo","sphereComposition","Initialize","operationData","points","imageVoxelManager","viewport","segmentationImageData","segmentationVoxelManager","center","fromValues","forEach","point","add","scale","length","centerWorld","centerIJK","boundsIJK","newBoundsIJK","topLeftWorld","bottomRightWorld","slice","isInObject","SPHERE_STRATEGY","regionFill","setValue","determineSegmentIndex","preview","fillInsideSphere","strategyFunction","SPHERE_THRESHOLD_STRATEGY","dynamicThreshold","threshold","islandRemoval","thresholdInsideSphere","fillOutsideSphere","Error"],"sources":["../../../../../src/tools/segmentation/strategies/fillSphere.ts"],"sourcesContent":[null],"mappings":"AACA,SAASA,SAAS,IAAIC,OAAO,QAAQ,qBAAqB;AAC1D,SAASC,IAAI,QAAQ,WAAW;AAEhC,OAAOC,aAAa,MAAM,iBAAiB;AAE3C,OAAOC,YAAY,MAAM,gBAAgB;AACzC,OAAOC,iBAAiB,MAAM,kCAAkC;AAChE,SAASC,oBAAoB,QAAQ,cAAc;AACnD,MAAM;EAAEC;AAAqB,CAAE,GAAGN,OAAO;AACzC,SAASO,mBAAmB,QAAQ,wCAAwC;AAC5E,MAAMC,iBAAiB,GAAG;EACxB,CAACJ,iBAAiB,CAACK,UAAU,GAAIC,aAAuC,IAAI;IAC1E,MAAM;MACJC,MAAM;MACNC,iBAAiB,EAAEA,iBAAiB;MACpCC,QAAQ;MACRC,qBAAqB;MACrBC,wBAAwB,EAAEA;IAAwB,CACnD,GAAGL,aAAa;IAGjB,IAAI,CAACC,MAAM,EAAE;MACX;;IAGF,MAAMK,MAAM,GAAGf,IAAI,CAACgB,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACvCN,MAAM,CAACO,OAAO,CAAEC,KAAK,IAAI;MACvBlB,IAAI,CAACmB,GAAG,CAACJ,MAAM,EAAEA,MAAM,EAAEG,KAAK,CAAC;IACjC,CAAC,CAAC;IACFlB,IAAI,CAACoB,KAAK,CAACL,MAAM,EAAEA,MAAM,EAAE,CAAC,GAAGL,MAAM,CAACW,MAAM,CAAC;IAE7CZ,aAAa,CAACa,WAAW,GAAGP,MAAsB;IAClDN,aAAa,CAACc,SAAS,GAAGlB,qBAAqB,CAC7CQ,qBAAqB,EACrBE,MAAsB,CACvB;IAED,MAAM;MACJS,SAAS,EAAEC,YAAY;MACvBC,YAAY;MACZC;IAAgB,CACjB,GAAGrB,mBAAmB,CACrBI,MAAM,CAACkB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAiC,EAClDf,qBAAqB,EACrBD,QAAQ,CACT;IAEDE,wBAAwB,CAACU,SAAS,GAAGC,YAAY;IAEjDd,iBAAiB,CAACkB,UAAU,GAAGzB,oBAAoB,CAAC;MAClDsB,YAAY;MACZC,gBAAgB;MAChBZ;KACD,CAAC;EACJ;CACc;AAEhB,MAAMe,eAAe,GAAG,IAAI7B,aAAa,CACvC,QAAQ,EACRC,YAAY,CAAC6B,UAAU,EACvB7B,YAAY,CAAC8B,QAAQ,EACrBzB,iBAAiB,EACjBL,YAAY,CAAC+B,qBAAqB,EAClC/B,YAAY,CAACgC,OAAO,CACrB;AAQD,MAAMC,gBAAgB,GAAGL,eAAe,CAACM,gBAAgB;AAEzD,MAAMC,yBAAyB,GAAG,IAAIpC,aAAa,CACjD,iBAAiB,EACjB,GAAG6B,eAAe,CAAC5B,YAAY,EAC/BA,YAAY,CAACoC,gBAAgB,EAC7BpC,YAAY,CAACqC,SAAS,EACtBrC,YAAY,CAACsC,aAAa,CAC3B;AASD,MAAMC,qBAAqB,GAAGJ,yBAAyB,CAACD,gBAAgB;AAQxE,OAAM,SAAUM,iBAAiBA,CAAA;EAC/B,MAAM,IAAIC,KAAK,CAAC,qCAAqC,CAAC;AACxD;AAEA,SAASR,gBAAgB,EAAEM,qBAAqB,EAAEX,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}