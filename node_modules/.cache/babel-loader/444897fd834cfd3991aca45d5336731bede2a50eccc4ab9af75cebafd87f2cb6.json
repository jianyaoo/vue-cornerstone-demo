{"ast":null,"code":"export class BucketQueue {\n  constructor({\n    numBits,\n    getPriority,\n    areEqual\n  }) {\n    this._bucketCount = 1 << numBits;\n    this._mask = this._bucketCount - 1;\n    this._size = 0;\n    this._currentBucketIndex = 0;\n    this._buckets = this._buildArray(this._bucketCount);\n    this._getPriority = typeof getPriority !== 'undefined' ? getPriority : item => item;\n    this._areEqual = typeof areEqual === 'function' ? areEqual : (itemA, itemB) => itemA === itemB;\n  }\n  push(item) {\n    const bucketIndex = this._getBucketIndex(item);\n    const oldHead = this._buckets[bucketIndex];\n    const newHead = {\n      value: item,\n      next: oldHead\n    };\n    this._buckets[bucketIndex] = newHead;\n    this._size++;\n  }\n  pop() {\n    if (this._size === 0) {\n      throw new Error('Cannot pop because the queue is empty.');\n    }\n    while (this._buckets[this._currentBucketIndex] === null) {\n      this._currentBucketIndex = (this._currentBucketIndex + 1) % this._bucketCount;\n    }\n    const ret = this._buckets[this._currentBucketIndex];\n    this._buckets[this._currentBucketIndex] = ret.next;\n    this._size--;\n    return ret.value;\n  }\n  remove(item) {\n    if (!item) {\n      return false;\n    }\n    const bucketIndex = this._getBucketIndex(item);\n    const firstBucketNode = this._buckets[bucketIndex];\n    let node = firstBucketNode;\n    let prevNode;\n    while (node !== null) {\n      if (this._areEqual(item, node.value)) {\n        break;\n      }\n      prevNode = node;\n      node = node.next;\n    }\n    if (node === null) {\n      return false;\n    }\n    if (node === firstBucketNode) {\n      this._buckets[bucketIndex] = node.next;\n    } else {\n      prevNode.next = node.next;\n    }\n    this._size--;\n    return true;\n  }\n  isEmpty() {\n    return this._size === 0;\n  }\n  _getBucketIndex(item) {\n    return this._getPriority(item) & this._mask;\n  }\n  _buildArray(size) {\n    const buckets = new Array(size);\n    buckets.fill(null);\n    return buckets;\n  }\n}","map":{"version":3,"names":["BucketQueue","constructor","numBits","getPriority","areEqual","_bucketCount","_mask","_size","_currentBucketIndex","_buckets","_buildArray","_getPriority","item","_areEqual","itemA","itemB","push","bucketIndex","_getBucketIndex","oldHead","newHead","value","next","pop","Error","ret","remove","firstBucketNode","node","prevNode","isEmpty","size","buckets","Array","fill"],"sources":["../../../src/utilities/BucketQueue.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}