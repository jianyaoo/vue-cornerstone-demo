{"ast":null,"code":"import { Events } from '../../enums';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { roundNumber } from '../../utilities';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg } from '../../drawingSvg';\nimport { state } from '../../store';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor } from '../../cursors/elementCursor';\nconst {\n  transformWorldToIndex\n} = csUtils;\nclass LengthTool extends AnnotationTool {\n  constructor(toolProps = {}, defaultToolProps = {\n    supportedInteractionTypes: ['Mouse', 'Touch'],\n    configuration: {\n      preventHandleOutsideImage: false,\n      getTextLines: defaultGetTextLines\n    }\n  }) {\n    super(toolProps, defaultToolProps);\n    this.addNewAnnotation = evt => {\n      const eventDetail = evt.detail;\n      const {\n        currentPoints,\n        element\n      } = eventDetail;\n      const worldPos = currentPoints.world;\n      const enabledElement = getEnabledElement(element);\n      const {\n        viewport,\n        renderingEngine\n      } = enabledElement;\n      hideElementCursor(element);\n      this.isDrawing = true;\n      const camera = viewport.getCamera();\n      const {\n        viewPlaneNormal,\n        viewUp\n      } = camera;\n      const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n      const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n      const annotation = {\n        highlighted: true,\n        invalidated: true,\n        metadata: {\n          toolName: this.getToolName(),\n          viewPlaneNormal: [...viewPlaneNormal],\n          viewUp: [...viewUp],\n          FrameOfReferenceUID,\n          referencedImageId\n        },\n        data: {\n          handles: {\n            points: [[...worldPos], [...worldPos]],\n            activeHandleIndex: null,\n            textBox: {\n              hasMoved: false,\n              worldPosition: [0, 0, 0],\n              worldBoundingBox: {\n                topLeft: [0, 0, 0],\n                topRight: [0, 0, 0],\n                bottomLeft: [0, 0, 0],\n                bottomRight: [0, 0, 0]\n              }\n            }\n          },\n          label: '',\n          cachedStats: {}\n        }\n      };\n      addAnnotation(annotation, element);\n      const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n      this.editData = {\n        annotation,\n        viewportIdsToRender,\n        handleIndex: 1,\n        movingTextBox: false,\n        newAnnotation: true,\n        hasMoved: false\n      };\n      this._activateDraw(element);\n      evt.preventDefault();\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      return annotation;\n    };\n    this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n      const enabledElement = getEnabledElement(element);\n      const {\n        viewport\n      } = enabledElement;\n      const {\n        data\n      } = annotation;\n      const [point1, point2] = data.handles.points;\n      const canvasPoint1 = viewport.worldToCanvas(point1);\n      const canvasPoint2 = viewport.worldToCanvas(point2);\n      const line = {\n        start: {\n          x: canvasPoint1[0],\n          y: canvasPoint1[1]\n        },\n        end: {\n          x: canvasPoint2[0],\n          y: canvasPoint2[1]\n        }\n      };\n      const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n      if (distanceToPoint <= proximity) {\n        return true;\n      }\n      return false;\n    };\n    this.toolSelectedCallback = (evt, annotation) => {\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      annotation.highlighted = true;\n      const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n      this.editData = {\n        annotation,\n        viewportIdsToRender,\n        movingTextBox: false\n      };\n      this._activateModify(element);\n      hideElementCursor(element);\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      evt.preventDefault();\n    };\n    this._endCallback = evt => {\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        newAnnotation,\n        hasMoved\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (newAnnotation && !hasMoved) {\n        return;\n      }\n      data.handles.activeHandleIndex = null;\n      this._deactivateModify(element);\n      this._deactivateDraw(element);\n      resetElementCursor(element);\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      if (this.isHandleOutsideImage && this.configuration.preventHandleOutsideImage) {\n        removeAnnotation(annotation.annotationUID);\n      }\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      if (newAnnotation) {\n        const eventType = Events.ANNOTATION_COMPLETED;\n        const eventDetail = {\n          annotation\n        };\n        triggerEvent(eventTarget, eventType, eventDetail);\n      }\n      this.editData = null;\n      this.isDrawing = false;\n    };\n    this._dragCallback = evt => {\n      this.isDrawing = true;\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        handleIndex,\n        movingTextBox\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (movingTextBox) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const {\n          textBox\n        } = data.handles;\n        const {\n          worldPosition\n        } = textBox;\n        worldPosition[0] += worldPosDelta[0];\n        worldPosition[1] += worldPosDelta[1];\n        worldPosition[2] += worldPosDelta[2];\n        textBox.hasMoved = true;\n      } else if (handleIndex === undefined) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const points = data.handles.points;\n        points.forEach(point => {\n          point[0] += worldPosDelta[0];\n          point[1] += worldPosDelta[1];\n          point[2] += worldPosDelta[2];\n        });\n        annotation.invalidated = true;\n      } else {\n        const {\n          currentPoints\n        } = eventDetail;\n        const worldPos = currentPoints.world;\n        data.handles.points[handleIndex] = [...worldPos];\n        annotation.invalidated = true;\n      }\n      this.editData.hasMoved = true;\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    };\n    this.cancel = element => {\n      if (this.isDrawing) {\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const {\n          annotation,\n          viewportIdsToRender,\n          newAnnotation\n        } = this.editData;\n        const {\n          data\n        } = annotation;\n        annotation.highlighted = false;\n        data.handles.activeHandleIndex = null;\n        const enabledElement = getEnabledElement(element);\n        const {\n          renderingEngine\n        } = enabledElement;\n        triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n        if (newAnnotation) {\n          const eventType = Events.ANNOTATION_COMPLETED;\n          const eventDetail = {\n            annotation\n          };\n          triggerEvent(eventTarget, eventType, eventDetail);\n        }\n        this.editData = null;\n        return annotation.annotationUID;\n      }\n    };\n    this._activateModify = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n    };\n    this._deactivateModify = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n    };\n    this._activateDraw = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n    };\n    this._deactivateDraw = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n    };\n    this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n      let renderStatus = false;\n      const {\n        viewport\n      } = enabledElement;\n      const {\n        element\n      } = viewport;\n      let annotations = getAnnotations(this.getToolName(), element);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      const targetId = this.getTargetId(viewport);\n      const renderingEngine = viewport.getRenderingEngine();\n      const styleSpecifier = {\n        toolGroupId: this.toolGroupId,\n        toolName: this.getToolName(),\n        viewportId: enabledElement.viewport.id\n      };\n      for (let i = 0; i < annotations.length; i++) {\n        const annotation = annotations[i];\n        const {\n          annotationUID,\n          data\n        } = annotation;\n        const {\n          points,\n          activeHandleIndex\n        } = data.handles;\n        styleSpecifier.annotationUID = annotationUID;\n        const {\n          color,\n          lineWidth,\n          lineDash,\n          shadow\n        } = this.getAnnotationStyle({\n          annotation,\n          styleSpecifier\n        });\n        const canvasCoordinates = points.map(p => viewport.worldToCanvas(p));\n        let activeHandleCanvasCoords;\n        if (!data.cachedStats[targetId] || data.cachedStats[targetId].unit == null) {\n          data.cachedStats[targetId] = {\n            length: null,\n            unit: null\n          };\n          this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n        } else if (annotation.invalidated) {\n          this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n        }\n        if (!isAnnotationVisible(annotationUID)) {\n          continue;\n        }\n        if (!isAnnotationLocked(annotation) && !this.editData && activeHandleIndex !== null) {\n          activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (activeHandleCanvasCoords) {\n          const handleGroupUID = '0';\n          drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n            color,\n            lineDash,\n            lineWidth\n          });\n        }\n        const dataId = `${annotationUID}-line`;\n        const lineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n          color,\n          width: lineWidth,\n          lineDash,\n          shadow\n        }, dataId);\n        renderStatus = true;\n        if (!viewport.getRenderingEngine()) {\n          console.warn('Rendering Engine has been destroyed');\n          return renderStatus;\n        }\n        const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n        if (!options.visibility) {\n          data.handles.textBox = {\n            hasMoved: false,\n            worldPosition: [0, 0, 0],\n            worldBoundingBox: {\n              topLeft: [0, 0, 0],\n              topRight: [0, 0, 0],\n              bottomLeft: [0, 0, 0],\n              bottomRight: [0, 0, 0]\n            }\n          };\n          continue;\n        }\n        const textLines = this.configuration.getTextLines(data, targetId);\n        if (!data.handles.textBox.hasMoved) {\n          const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n          data.handles.textBox.worldPosition = viewport.canvasToWorld(canvasTextBoxCoords);\n        }\n        const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n        const textBoxUID = '1';\n        const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n        const {\n          x: left,\n          y: top,\n          width,\n          height\n        } = boundingBox;\n        data.handles.textBox.worldBoundingBox = {\n          topLeft: viewport.canvasToWorld([left, top]),\n          topRight: viewport.canvasToWorld([left + width, top]),\n          bottomLeft: viewport.canvasToWorld([left, top + height]),\n          bottomRight: viewport.canvasToWorld([left + width, top + height])\n        };\n      }\n      return renderStatus;\n    };\n    this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, {\n      trailing: true\n    });\n  }\n  handleSelectedCallback(evt, annotation, handle) {\n    const eventDetail = evt.detail;\n    const {\n      element\n    } = eventDetail;\n    const {\n      data\n    } = annotation;\n    annotation.highlighted = true;\n    let movingTextBox = false;\n    let handleIndex;\n    if (handle.worldPosition) {\n      movingTextBox = true;\n    } else {\n      handleIndex = data.handles.points.findIndex(p => p === handle);\n    }\n    const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n    this.editData = {\n      annotation,\n      viewportIdsToRender,\n      handleIndex,\n      movingTextBox\n    };\n    this._activateModify(element);\n    hideElementCursor(element);\n    const enabledElement = getEnabledElement(element);\n    const {\n      renderingEngine\n    } = enabledElement;\n    triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    evt.preventDefault();\n  }\n  _calculateLength(pos1, pos2) {\n    const dx = pos1[0] - pos2[0];\n    const dy = pos1[1] - pos2[1];\n    const dz = pos1[2] - pos2[2];\n    return Math.sqrt(dx * dx + dy * dy + dz * dz);\n  }\n  _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n    const data = annotation.data;\n    const {\n      viewportId,\n      renderingEngineId\n    } = enabledElement;\n    const worldPos1 = data.handles.points[0];\n    const worldPos2 = data.handles.points[1];\n    const {\n      cachedStats\n    } = data;\n    const targetIds = Object.keys(cachedStats);\n    for (let i = 0; i < targetIds.length; i++) {\n      const targetId = targetIds[i];\n      const image = this.getTargetIdImage(targetId, renderingEngine);\n      if (!image) {\n        continue;\n      }\n      const {\n        imageData,\n        dimensions\n      } = image;\n      const index1 = transformWorldToIndex(imageData, worldPos1);\n      const index2 = transformWorldToIndex(imageData, worldPos2);\n      const handles = [index1, index2];\n      const {\n        scale,\n        units\n      } = getCalibratedLengthUnitsAndScale(image, handles);\n      const length = this._calculateLength(worldPos1, worldPos2) / scale;\n      this._isInsideVolume(index1, index2, dimensions) ? this.isHandleOutsideImage = false : this.isHandleOutsideImage = true;\n      cachedStats[targetId] = {\n        length,\n        unit: units\n      };\n    }\n    annotation.invalidated = false;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n      annotation,\n      viewportId,\n      renderingEngineId\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n    return cachedStats;\n  }\n  _isInsideVolume(index1, index2, dimensions) {\n    return csUtils.indexWithinDimensions(index1, dimensions) && csUtils.indexWithinDimensions(index2, dimensions);\n  }\n}\nfunction defaultGetTextLines(data, targetId) {\n  const cachedVolumeStats = data.cachedStats[targetId];\n  const {\n    length,\n    unit\n  } = cachedVolumeStats;\n  if (length === undefined || length === null || isNaN(length)) {\n    return;\n  }\n  const textLines = [`${roundNumber(length)} ${unit}`];\n  return textLines;\n}\nLengthTool.toolName = 'Length';\nexport default LengthTool;","map":{"version":3,"names":["Events","getEnabledElement","triggerEvent","eventTarget","utilities","csUtils","getCalibratedLengthUnitsAndScale","roundNumber","AnnotationTool","throttle","addAnnotation","getAnnotations","removeAnnotation","isAnnotationLocked","isAnnotationVisible","lineSegment","drawHandles","drawHandlesSvg","drawLine","drawLineSvg","drawLinkedTextBox","drawLinkedTextBoxSvg","state","getViewportIdsWithToolToRender","getTextBoxCoordsCanvas","triggerAnnotationRenderForViewportIds","resetElementCursor","hideElementCursor","transformWorldToIndex","LengthTool","constructor","toolProps","defaultToolProps","supportedInteractionTypes","configuration","preventHandleOutsideImage","getTextLines","defaultGetTextLines","addNewAnnotation","evt","eventDetail","detail","currentPoints","element","worldPos","world","enabledElement","viewport","renderingEngine","isDrawing","camera","getCamera","viewPlaneNormal","viewUp","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getFrameOfReferenceUID","annotation","highlighted","invalidated","metadata","toolName","getToolName","data","handles","points","activeHandleIndex","textBox","hasMoved","worldPosition","worldBoundingBox","topLeft","topRight","bottomLeft","bottomRight","label","cachedStats","viewportIdsToRender","editData","handleIndex","movingTextBox","newAnnotation","_activateDraw","preventDefault","isPointNearTool","canvasCoords","proximity","point1","point2","canvasPoint1","worldToCanvas","canvasPoint2","line","start","x","y","end","distanceToPoint","toolSelectedCallback","_activateModify","_endCallback","_deactivateModify","_deactivateDraw","isHandleOutsideImage","annotationUID","eventType","ANNOTATION_COMPLETED","_dragCallback","deltaPoints","worldPosDelta","undefined","forEach","point","cancel","isInteractingWithTool","addEventListener","MOUSE_UP","MOUSE_DRAG","MOUSE_CLICK","TOUCH_END","TOUCH_DRAG","TOUCH_TAP","removeEventListener","MOUSE_MOVE","renderAnnotation","svgDrawingHelper","renderStatus","annotations","length","filterInteractableAnnotationsForElement","targetId","getTargetId","getRenderingEngine","styleSpecifier","toolGroupId","viewportId","id","i","color","lineWidth","lineDash","shadow","getAnnotationStyle","canvasCoordinates","map","p","activeHandleCanvasCoords","unit","_calculateCachedStats","_throttledCalculateCachedStats","handleGroupUID","dataId","lineUID","width","console","warn","options","getLinkedTextBoxStyle","visibility","textLines","canvasTextBoxCoords","canvasToWorld","textBoxPosition","textBoxUID","boundingBox","left","top","height","trailing","handleSelectedCallback","handle","findIndex","_calculateLength","pos1","pos2","dx","dy","dz","Math","sqrt","renderingEngineId","worldPos1","worldPos2","targetIds","Object","keys","image","getTargetIdImage","imageData","dimensions","index1","index2","scale","units","_isInsideVolume","ANNOTATION_MODIFIED","indexWithinDimensions","cachedVolumeStats","isNaN"],"sources":["../../../../src/tools/annotation/LengthTool.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}