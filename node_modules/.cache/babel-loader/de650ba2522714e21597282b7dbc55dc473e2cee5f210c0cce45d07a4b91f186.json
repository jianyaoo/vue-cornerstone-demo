{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { m as macro } from '../../macros2.js';\nimport HalfFloat from '../../Common/Core/HalfFloat.js';\nimport vtkWebGPUBufferManager from './BufferManager.js';\nimport vtkWebGPUTextureView from './TextureView.js';\nimport vtkWebGPUTypes from './Types.js';\nimport vtkTexture from '../Core/Texture.js';\nconst {\n  BufferUsage\n} = vtkWebGPUBufferManager;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkWebGPUTexture methods\n// ----------------------------------------------------------------------------\n\nfunction vtkWebGPUTexture(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkWebGPUTexture');\n  publicAPI.create = (device, options) => {\n    model.device = device;\n    model.width = options.width;\n    model.height = options.height;\n    model.depth = options.depth ? options.depth : 1;\n    const dimension = model.depth === 1 ? '2d' : '3d';\n    model.format = options.format ? options.format : 'rgba8unorm';\n    model.mipLevel = options.mipLevel ? options.mipLevel : 0;\n    /* eslint-disable no-undef */\n    /* eslint-disable no-bitwise */\n    model.usage = options.usage ? options.usage : GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    /* eslint-enable no-undef */\n    /* eslint-enable no-bitwise */\n    model.handle = model.device.getHandle().createTexture({\n      size: [model.width, model.height, model.depth],\n      format: model.format,\n      // 'rgba8unorm',\n      usage: model.usage,\n      label: model.label,\n      dimension,\n      mipLevelCount: model.mipLevel + 1\n    });\n  };\n  publicAPI.assignFromHandle = (device, handle, options) => {\n    model.device = device;\n    model.handle = handle;\n    model.width = options.width;\n    model.height = options.height;\n    model.depth = options.depth ? options.depth : 1;\n    model.format = options.format ? options.format : 'rgba8unorm';\n    /* eslint-disable no-undef */\n    /* eslint-disable no-bitwise */\n    model.usage = options.usage ? options.usage : GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    /* eslint-enable no-undef */\n    /* eslint-enable no-bitwise */\n  };\n  publicAPI.writeImageData = req => {\n    let nativeArray = [];\n    if (req.canvas) {\n      model.device.getHandle().queue.copyExternalImageToTexture({\n        source: req.canvas,\n        flipY: req.flip\n      }, {\n        texture: model.handle,\n        premultipliedAlpha: true\n      }, [model.width, model.height, model.depth]);\n      model.ready = true;\n      return;\n    }\n    if (req.jsImageData && !req.nativeArray) {\n      req.width = req.jsImageData.width;\n      req.height = req.jsImageData.height;\n      req.depth = 1;\n      req.format = 'rgba8unorm';\n      req.flip = true;\n      req.nativeArray = req.jsImageData.data;\n    }\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    let bufferBytesPerRow = model.width * tDetails.stride;\n    const fixAll = (arr, height, depth) => {\n      // bytesPerRow must be a multiple of 256 so we might need to rebuild\n      // the data here before passing to the buffer. e.g. if it is unorm8x4 then\n      // we need to have width be a multiple of 64\n      const inWidthInBytes = arr.length / (height * depth) * arr.BYTES_PER_ELEMENT;\n\n      // is this a half float texture?\n      const halfFloat = tDetails.elementSize === 2 && tDetails.sampleType === 'float';\n\n      // if we need to copy the data\n      if (halfFloat || inWidthInBytes % 256) {\n        const inArray = arr;\n        const inWidth = inWidthInBytes / inArray.BYTES_PER_ELEMENT;\n        const outBytesPerElement = tDetails.elementSize;\n        const outWidthInBytes = 256 * Math.floor((inWidth * outBytesPerElement + 255) / 256);\n        const outWidth = outWidthInBytes / outBytesPerElement;\n        const outArray = macro.newTypedArray(halfFloat ? 'Uint16Array' : inArray.constructor.name, outWidth * height * depth);\n        for (let v = 0; v < height * depth; v++) {\n          if (halfFloat) {\n            for (let i = 0; i < inWidth; i++) {\n              outArray[v * outWidth + i] = HalfFloat.toHalf(inArray[v * inWidth + i]);\n            }\n          } else {\n            outArray.set(inArray.subarray(v * inWidth, (v + 1) * inWidth), v * outWidth);\n          }\n        }\n        return [outArray, outWidthInBytes];\n      }\n      return [arr, inWidthInBytes];\n    };\n    if (req.nativeArray) {\n      nativeArray = req.nativeArray;\n    }\n    if (req.image) {\n      const canvas = document.createElement('canvas');\n      canvas.width = req.image.width;\n      canvas.height = req.image.height;\n      const ctx = canvas.getContext('2d');\n      ctx.translate(0, canvas.height);\n      ctx.scale(1, -1);\n      ctx.drawImage(req.image, 0, 0, req.image.width, req.image.height, 0, 0, canvas.width, canvas.height);\n      const imageData = ctx.getImageData(0, 0, req.image.width, req.image.height);\n      nativeArray = imageData.data;\n    }\n    const cmdEnc = model.device.createCommandEncoder();\n    if (publicAPI.getDimensionality() !== 3) {\n      // Non-3D, supports mipmaps\n      const mips = vtkTexture.generateMipmaps(nativeArray, model.width, model.height, model.mipLevel);\n      let currentWidth = model.width;\n      let currentHeight = model.height;\n      for (let m = 0; m <= model.mipLevel; m++) {\n        const fix = fixAll(mips[m], currentHeight, 1);\n        bufferBytesPerRow = fix[1];\n        const buffRequest = {\n          dataArray: req.dataArray ? req.dataArray : null,\n          nativeArray: fix[0],\n          /* eslint-disable no-undef */\n          usage: BufferUsage.Texture\n          /* eslint-enable no-undef */\n        };\n        const buff = model.device.getBufferManager().getBuffer(buffRequest);\n        cmdEnc.copyBufferToTexture({\n          buffer: buff.getHandle(),\n          offset: 0,\n          bytesPerRow: bufferBytesPerRow,\n          rowsPerImage: currentHeight\n        }, {\n          texture: model.handle,\n          mipLevel: m\n        }, [currentWidth, currentHeight, 1]);\n        currentWidth /= 2;\n        currentHeight /= 2;\n      }\n      model.device.submitCommandEncoder(cmdEnc);\n      model.ready = true;\n    } else {\n      // 3D, no mipmaps\n      const fix = fixAll(nativeArray, model.height, model.depth);\n      bufferBytesPerRow = fix[1];\n      const buffRequest = {\n        dataArray: req.dataArray ? req.dataArray : null,\n        /* eslint-disable no-undef */\n        usage: BufferUsage.Texture\n        /* eslint-enable no-undef */\n      };\n      buffRequest.nativeArray = fix[0];\n      const buff = model.device.getBufferManager().getBuffer(buffRequest);\n      cmdEnc.copyBufferToTexture({\n        buffer: buff.getHandle(),\n        offset: 0,\n        bytesPerRow: bufferBytesPerRow,\n        rowsPerImage: model.height\n      }, {\n        texture: model.handle\n      }, [model.width, model.height, model.depth]);\n      model.device.submitCommandEncoder(cmdEnc);\n      model.ready = true;\n    }\n  };\n\n  // when data is pulled out of this texture what scale must be applied to\n  // get back to the original source data. For formats such as r8unorm we\n  // have to multiply by 255.0, for formats such as r16float it is 1.0\n  publicAPI.getScale = () => {\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    const halfFloat = tDetails.elementSize === 2 && tDetails.sampleType === 'float';\n    return halfFloat ? 1.0 : 255.0;\n  };\n  publicAPI.getNumberOfComponents = () => {\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    return tDetails.numComponents;\n  };\n  publicAPI.getDimensionality = () => {\n    let dims = 0;\n    if (model.width > 1) dims++;\n    if (model.height > 1) dims++;\n    if (model.depth > 1) dims++;\n    return dims;\n  };\n  publicAPI.resizeToMatch = tex => {\n    if (tex.getWidth() !== model.width || tex.getHeight() !== model.height || tex.getDepth() !== model.depth) {\n      model.width = tex.getWidth();\n      model.height = tex.getHeight();\n      model.depth = tex.getDepth();\n      model.handle = model.device.getHandle().createTexture({\n        size: [model.width, model.height, model.depth],\n        format: model.format,\n        usage: model.usage,\n        label: model.label\n      });\n    }\n  };\n  publicAPI.resize = function (width, height) {\n    let depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    if (width !== model.width || height !== model.height || depth !== model.depth) {\n      model.width = width;\n      model.height = height;\n      model.depth = depth;\n      model.handle = model.device.getHandle().createTexture({\n        size: [model.width, model.height, model.depth],\n        format: model.format,\n        usage: model.usage,\n        label: model.label\n      });\n    }\n  };\n  publicAPI.createView = function (label) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // if options is missing values try to add them in\n    if (!options.dimension) {\n      options.dimension = model.depth === 1 ? '2d' : '3d';\n    }\n    const view = vtkWebGPUTextureView.newInstance({\n      label\n    });\n    view.create(publicAPI, options);\n    return view;\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  device: null,\n  handle: null,\n  buffer: null,\n  ready: false,\n  label: null\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Object methods\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['handle', 'ready', 'width', 'height', 'depth', 'format', 'usage']);\n  macro.setGet(publicAPI, model, ['device', 'label']);\n  vtkWebGPUTexture(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend);\n\n// ----------------------------------------------------------------------------\n\nvar vtkWebGPUTexture$1 = {\n  newInstance,\n  extend\n};\nexport { vtkWebGPUTexture$1 as default, extend, newInstance };","map":{"version":3,"names":["m","macro","HalfFloat","vtkWebGPUBufferManager","vtkWebGPUTextureView","vtkWebGPUTypes","vtkTexture","BufferUsage","vtkWebGPUTexture","publicAPI","model","classHierarchy","push","create","device","options","width","height","depth","dimension","format","mipLevel","usage","GPUTextureUsage","TEXTURE_BINDING","COPY_DST","handle","getHandle","createTexture","size","label","mipLevelCount","assignFromHandle","writeImageData","req","nativeArray","canvas","queue","copyExternalImageToTexture","source","flipY","flip","texture","premultipliedAlpha","ready","jsImageData","data","tDetails","getDetailsFromTextureFormat","bufferBytesPerRow","stride","fixAll","arr","inWidthInBytes","length","BYTES_PER_ELEMENT","halfFloat","elementSize","sampleType","inArray","inWidth","outBytesPerElement","outWidthInBytes","Math","floor","outWidth","outArray","newTypedArray","constructor","name","v","i","toHalf","set","subarray","image","document","createElement","ctx","getContext","translate","scale","drawImage","imageData","getImageData","cmdEnc","createCommandEncoder","getDimensionality","mips","generateMipmaps","currentWidth","currentHeight","fix","buffRequest","dataArray","Texture","buff","getBufferManager","getBuffer","copyBufferToTexture","buffer","offset","bytesPerRow","rowsPerImage","submitCommandEncoder","getScale","getNumberOfComponents","numComponents","dims","resizeToMatch","tex","getWidth","getHeight","getDepth","resize","arguments","undefined","createView","view","newInstance","DEFAULT_VALUES","extend","initialValues","Object","assign","obj","get","setGet","vtkWebGPUTexture$1","default"],"sources":["/Users/yzy/Documents/Playground/vue-cornerstone-demo/node_modules/@kitware/vtk.js/Rendering/WebGPU/Texture.js"],"sourcesContent":["import { m as macro } from '../../macros2.js';\nimport HalfFloat from '../../Common/Core/HalfFloat.js';\nimport vtkWebGPUBufferManager from './BufferManager.js';\nimport vtkWebGPUTextureView from './TextureView.js';\nimport vtkWebGPUTypes from './Types.js';\nimport vtkTexture from '../Core/Texture.js';\n\nconst {\n  BufferUsage\n} = vtkWebGPUBufferManager;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkWebGPUTexture methods\n// ----------------------------------------------------------------------------\n\nfunction vtkWebGPUTexture(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkWebGPUTexture');\n  publicAPI.create = (device, options) => {\n    model.device = device;\n    model.width = options.width;\n    model.height = options.height;\n    model.depth = options.depth ? options.depth : 1;\n    const dimension = model.depth === 1 ? '2d' : '3d';\n    model.format = options.format ? options.format : 'rgba8unorm';\n    model.mipLevel = options.mipLevel ? options.mipLevel : 0;\n    /* eslint-disable no-undef */\n    /* eslint-disable no-bitwise */\n    model.usage = options.usage ? options.usage : GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    /* eslint-enable no-undef */\n    /* eslint-enable no-bitwise */\n    model.handle = model.device.getHandle().createTexture({\n      size: [model.width, model.height, model.depth],\n      format: model.format,\n      // 'rgba8unorm',\n      usage: model.usage,\n      label: model.label,\n      dimension,\n      mipLevelCount: model.mipLevel + 1\n    });\n  };\n  publicAPI.assignFromHandle = (device, handle, options) => {\n    model.device = device;\n    model.handle = handle;\n    model.width = options.width;\n    model.height = options.height;\n    model.depth = options.depth ? options.depth : 1;\n    model.format = options.format ? options.format : 'rgba8unorm';\n    /* eslint-disable no-undef */\n    /* eslint-disable no-bitwise */\n    model.usage = options.usage ? options.usage : GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;\n    /* eslint-enable no-undef */\n    /* eslint-enable no-bitwise */\n  };\n\n  publicAPI.writeImageData = req => {\n    let nativeArray = [];\n    if (req.canvas) {\n      model.device.getHandle().queue.copyExternalImageToTexture({\n        source: req.canvas,\n        flipY: req.flip\n      }, {\n        texture: model.handle,\n        premultipliedAlpha: true\n      }, [model.width, model.height, model.depth]);\n      model.ready = true;\n      return;\n    }\n    if (req.jsImageData && !req.nativeArray) {\n      req.width = req.jsImageData.width;\n      req.height = req.jsImageData.height;\n      req.depth = 1;\n      req.format = 'rgba8unorm';\n      req.flip = true;\n      req.nativeArray = req.jsImageData.data;\n    }\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    let bufferBytesPerRow = model.width * tDetails.stride;\n    const fixAll = (arr, height, depth) => {\n      // bytesPerRow must be a multiple of 256 so we might need to rebuild\n      // the data here before passing to the buffer. e.g. if it is unorm8x4 then\n      // we need to have width be a multiple of 64\n      const inWidthInBytes = arr.length / (height * depth) * arr.BYTES_PER_ELEMENT;\n\n      // is this a half float texture?\n      const halfFloat = tDetails.elementSize === 2 && tDetails.sampleType === 'float';\n\n      // if we need to copy the data\n      if (halfFloat || inWidthInBytes % 256) {\n        const inArray = arr;\n        const inWidth = inWidthInBytes / inArray.BYTES_PER_ELEMENT;\n        const outBytesPerElement = tDetails.elementSize;\n        const outWidthInBytes = 256 * Math.floor((inWidth * outBytesPerElement + 255) / 256);\n        const outWidth = outWidthInBytes / outBytesPerElement;\n        const outArray = macro.newTypedArray(halfFloat ? 'Uint16Array' : inArray.constructor.name, outWidth * height * depth);\n        for (let v = 0; v < height * depth; v++) {\n          if (halfFloat) {\n            for (let i = 0; i < inWidth; i++) {\n              outArray[v * outWidth + i] = HalfFloat.toHalf(inArray[v * inWidth + i]);\n            }\n          } else {\n            outArray.set(inArray.subarray(v * inWidth, (v + 1) * inWidth), v * outWidth);\n          }\n        }\n        return [outArray, outWidthInBytes];\n      }\n      return [arr, inWidthInBytes];\n    };\n    if (req.nativeArray) {\n      nativeArray = req.nativeArray;\n    }\n    if (req.image) {\n      const canvas = document.createElement('canvas');\n      canvas.width = req.image.width;\n      canvas.height = req.image.height;\n      const ctx = canvas.getContext('2d');\n      ctx.translate(0, canvas.height);\n      ctx.scale(1, -1);\n      ctx.drawImage(req.image, 0, 0, req.image.width, req.image.height, 0, 0, canvas.width, canvas.height);\n      const imageData = ctx.getImageData(0, 0, req.image.width, req.image.height);\n      nativeArray = imageData.data;\n    }\n    const cmdEnc = model.device.createCommandEncoder();\n    if (publicAPI.getDimensionality() !== 3) {\n      // Non-3D, supports mipmaps\n      const mips = vtkTexture.generateMipmaps(nativeArray, model.width, model.height, model.mipLevel);\n      let currentWidth = model.width;\n      let currentHeight = model.height;\n      for (let m = 0; m <= model.mipLevel; m++) {\n        const fix = fixAll(mips[m], currentHeight, 1);\n        bufferBytesPerRow = fix[1];\n        const buffRequest = {\n          dataArray: req.dataArray ? req.dataArray : null,\n          nativeArray: fix[0],\n          /* eslint-disable no-undef */\n          usage: BufferUsage.Texture\n          /* eslint-enable no-undef */\n        };\n\n        const buff = model.device.getBufferManager().getBuffer(buffRequest);\n        cmdEnc.copyBufferToTexture({\n          buffer: buff.getHandle(),\n          offset: 0,\n          bytesPerRow: bufferBytesPerRow,\n          rowsPerImage: currentHeight\n        }, {\n          texture: model.handle,\n          mipLevel: m\n        }, [currentWidth, currentHeight, 1]);\n        currentWidth /= 2;\n        currentHeight /= 2;\n      }\n      model.device.submitCommandEncoder(cmdEnc);\n      model.ready = true;\n    } else {\n      // 3D, no mipmaps\n      const fix = fixAll(nativeArray, model.height, model.depth);\n      bufferBytesPerRow = fix[1];\n      const buffRequest = {\n        dataArray: req.dataArray ? req.dataArray : null,\n        /* eslint-disable no-undef */\n        usage: BufferUsage.Texture\n        /* eslint-enable no-undef */\n      };\n\n      buffRequest.nativeArray = fix[0];\n      const buff = model.device.getBufferManager().getBuffer(buffRequest);\n      cmdEnc.copyBufferToTexture({\n        buffer: buff.getHandle(),\n        offset: 0,\n        bytesPerRow: bufferBytesPerRow,\n        rowsPerImage: model.height\n      }, {\n        texture: model.handle\n      }, [model.width, model.height, model.depth]);\n      model.device.submitCommandEncoder(cmdEnc);\n      model.ready = true;\n    }\n  };\n\n  // when data is pulled out of this texture what scale must be applied to\n  // get back to the original source data. For formats such as r8unorm we\n  // have to multiply by 255.0, for formats such as r16float it is 1.0\n  publicAPI.getScale = () => {\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    const halfFloat = tDetails.elementSize === 2 && tDetails.sampleType === 'float';\n    return halfFloat ? 1.0 : 255.0;\n  };\n  publicAPI.getNumberOfComponents = () => {\n    const tDetails = vtkWebGPUTypes.getDetailsFromTextureFormat(model.format);\n    return tDetails.numComponents;\n  };\n  publicAPI.getDimensionality = () => {\n    let dims = 0;\n    if (model.width > 1) dims++;\n    if (model.height > 1) dims++;\n    if (model.depth > 1) dims++;\n    return dims;\n  };\n  publicAPI.resizeToMatch = tex => {\n    if (tex.getWidth() !== model.width || tex.getHeight() !== model.height || tex.getDepth() !== model.depth) {\n      model.width = tex.getWidth();\n      model.height = tex.getHeight();\n      model.depth = tex.getDepth();\n      model.handle = model.device.getHandle().createTexture({\n        size: [model.width, model.height, model.depth],\n        format: model.format,\n        usage: model.usage,\n        label: model.label\n      });\n    }\n  };\n  publicAPI.resize = function (width, height) {\n    let depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    if (width !== model.width || height !== model.height || depth !== model.depth) {\n      model.width = width;\n      model.height = height;\n      model.depth = depth;\n      model.handle = model.device.getHandle().createTexture({\n        size: [model.width, model.height, model.depth],\n        format: model.format,\n        usage: model.usage,\n        label: model.label\n      });\n    }\n  };\n  publicAPI.createView = function (label) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // if options is missing values try to add them in\n    if (!options.dimension) {\n      options.dimension = model.depth === 1 ? '2d' : '3d';\n    }\n    const view = vtkWebGPUTextureView.newInstance({\n      label\n    });\n    view.create(publicAPI, options);\n    return view;\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  device: null,\n  handle: null,\n  buffer: null,\n  ready: false,\n  label: null\n};\n\n// ----------------------------------------------------------------------------\n\nfunction extend(publicAPI, model) {\n  let initialValues = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Object methods\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['handle', 'ready', 'width', 'height', 'depth', 'format', 'usage']);\n  macro.setGet(publicAPI, model, ['device', 'label']);\n  vtkWebGPUTexture(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nconst newInstance = macro.newInstance(extend);\n\n// ----------------------------------------------------------------------------\n\nvar vtkWebGPUTexture$1 = {\n  newInstance,\n  extend\n};\n\nexport { vtkWebGPUTexture$1 as default, extend, newInstance };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}