{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nconst globalLockedAnnotationsSet = new Set();\nfunction setAnnotationLocked(annotation, locked = true) {\n  const detail = makeEventDetail();\n  if (annotation) {\n    if (locked) {\n      lock(annotation, globalLockedAnnotationsSet, detail);\n    } else {\n      unlock(annotation, globalLockedAnnotationsSet, detail);\n    }\n  }\n  publish(detail, globalLockedAnnotationsSet);\n}\nfunction unlockAllAnnotations() {\n  const detail = makeEventDetail();\n  clearLockedAnnotationsSet(globalLockedAnnotationsSet, detail);\n  publish(detail, globalLockedAnnotationsSet);\n}\nfunction getAnnotationsLocked() {\n  return Array.from(globalLockedAnnotationsSet);\n}\nfunction isAnnotationLocked(annotation) {\n  return globalLockedAnnotationsSet.has(annotation);\n}\nfunction getAnnotationsLockedCount() {\n  return globalLockedAnnotationsSet.size;\n}\nfunction checkAndDefineIsLockedProperty(annotation) {\n  if (annotation) {\n    const isLocked = !!annotation.isLocked;\n    if (shouldDefineIsLockedProperty(annotation)) {\n      Object.defineProperty(annotation, 'isLocked', {\n        configurable: false,\n        enumerable: true,\n        set: setIsLocked,\n        get: getIsLocked\n      });\n    }\n    setAnnotationLocked(annotation, isLocked);\n  }\n}\nfunction makeEventDetail() {\n  return Object.freeze({\n    added: [],\n    removed: [],\n    locked: []\n  });\n}\nfunction lock(annotation, lockedAnnotationsSet, detail) {\n  if (!lockedAnnotationsSet.has(annotation)) {\n    lockedAnnotationsSet.add(annotation);\n    detail.added.push(annotation);\n  }\n}\nfunction unlock(annotation, lockedAnnotationsSet, detail) {\n  if (lockedAnnotationsSet.delete(annotation)) {\n    detail.removed.push(annotation);\n  }\n}\nfunction clearLockedAnnotationsSet(lockedAnnotationsSet, detail) {\n  lockedAnnotationsSet.forEach(annotation => {\n    unlock(annotation, lockedAnnotationsSet, detail);\n  });\n}\nfunction publish(detail, lockedAnnotationsSet) {\n  if (detail.added.length > 0 || detail.removed.length > 0) {\n    lockedAnnotationsSet.forEach(item => void detail.locked.push(item));\n    triggerEvent(eventTarget, Events.ANNOTATION_LOCK_CHANGE, detail);\n  }\n}\nfunction shouldDefineIsLockedProperty(annotation) {\n  const descriptor = Object.getOwnPropertyDescriptor(annotation, 'isLocked');\n  if (descriptor) {\n    return descriptor.configurable && (descriptor.set !== setIsLocked || descriptor.get !== getIsLocked);\n  }\n  return Object.isExtensible(annotation);\n}\nfunction setIsLocked(locked) {\n  setAnnotationLocked(this, locked);\n}\nfunction getIsLocked() {\n  return isAnnotationLocked(this);\n}\nexport { setAnnotationLocked, getAnnotationsLocked, getAnnotationsLockedCount, unlockAllAnnotations, isAnnotationLocked, checkAndDefineIsLockedProperty };","map":{"version":3,"names":["eventTarget","triggerEvent","Events","globalLockedAnnotationsSet","Set","setAnnotationLocked","annotation","locked","detail","makeEventDetail","lock","unlock","publish","unlockAllAnnotations","clearLockedAnnotationsSet","getAnnotationsLocked","Array","from","isAnnotationLocked","has","getAnnotationsLockedCount","size","checkAndDefineIsLockedProperty","isLocked","shouldDefineIsLockedProperty","Object","defineProperty","configurable","enumerable","set","setIsLocked","get","getIsLocked","freeze","added","removed","lockedAnnotationsSet","add","push","delete","forEach","length","item","ANNOTATION_LOCK_CHANGE","descriptor","getOwnPropertyDescriptor","isExtensible"],"sources":["../../../../src/stateManagement/annotation/annotationLocking.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}