{"ast":null,"code":"import vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { utilities as csUtils } from '@cornerstonejs/core';\nexport default function getPointInLineOfSightWithCriteria(viewport, worldPos, targetVolumeId, criteriaFunction, stepSize = 0.25) {\n  const camera = viewport.getCamera();\n  const {\n    position: cameraPosition\n  } = camera;\n  const {\n    spacingInNormalDirection\n  } = csUtils.getTargetVolumeAndSpacingInNormalDir(viewport, camera, targetVolumeId);\n  const step = spacingInNormalDirection * stepSize;\n  const bounds = viewport.getBounds();\n  const xMin = bounds[0];\n  const xMax = bounds[1];\n  const vector = [0, 0, 0];\n  let point = [0, 0, 0];\n  vtkMath.subtract(worldPos, cameraPosition, vector);\n  let pickedPoint;\n  for (let pointT = xMin; pointT <= xMax; pointT = pointT + step) {\n    point = [pointT, 0, 0];\n    const t = (pointT - cameraPosition[0]) / vector[0];\n    point[1] = t * vector[1] + cameraPosition[1];\n    point[2] = t * vector[2] + cameraPosition[2];\n    if (_inBounds(point, bounds)) {\n      const intensity = viewport.getIntensityFromWorld(point);\n      const pointToPick = criteriaFunction(intensity, point);\n      if (pointToPick) {\n        pickedPoint = pointToPick;\n      }\n    }\n  }\n  return pickedPoint;\n}\nconst _inBounds = function (point, bounds) {\n  const [xMin, xMax, yMin, yMax, zMin, zMax] = bounds;\n  return point[0] > xMin && point[0] < xMax && point[1] > yMin && point[1] < yMax && point[2] > zMin && point[2] < zMax;\n};","map":{"version":3,"names":["vtkMath","utilities","csUtils","getPointInLineOfSightWithCriteria","viewport","worldPos","targetVolumeId","criteriaFunction","stepSize","camera","getCamera","position","cameraPosition","spacingInNormalDirection","getTargetVolumeAndSpacingInNormalDir","step","bounds","getBounds","xMin","xMax","vector","point","subtract","pickedPoint","pointT","t","_inBounds","intensity","getIntensityFromWorld","pointToPick","yMin","yMax","zMin","zMax"],"sources":["../../../../src/utilities/planar/getPointInLineOfSightWithCriteria.ts"],"sourcesContent":[null],"mappings":"AAAA,OAAOA,OAAO,MAAM,kCAAkC;AACtD,SAASC,SAAS,IAAIC,OAAO,QAAQ,qBAAqB;AAkB1D,eAAc,SAAUC,iCAAiCA,CACvDC,QAA+B,EAC/BC,QAAsB,EACtBC,cAAsB,EACtBC,gBAA0E,EAC1EC,QAAQ,GAAG,IAAI;EAGf,MAAMC,MAAM,GAAGL,QAAQ,CAACM,SAAS,EAAE;EACnC,MAAM;IAAEC,QAAQ,EAAEC;EAAc,CAAE,GAAGH,MAAM;EAI3C,MAAM;IAAEI;EAAwB,CAAE,GAChCX,OAAO,CAACY,oCAAoC,CAC1CV,QAAQ,EACRK,MAAM,EACNH,cAAc,CACf;EAEH,MAAMS,IAAI,GAAGF,wBAAwB,GAAGL,QAAQ;EAKhD,MAAMQ,MAAM,GAAGZ,QAAQ,CAACa,SAAS,EAAE;EACnC,MAAMC,IAAI,GAAGF,MAAM,CAAC,CAAC,CAAC;EACtB,MAAMG,IAAI,GAAGH,MAAM,CAAC,CAAC,CAAC;EAGtB,MAAMI,MAAM,GAAiB,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAGtC,IAAIC,KAAK,GAAiB,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAGnCrB,OAAO,CAACsB,QAAQ,CAACjB,QAAQ,EAAEO,cAAc,EAAEQ,MAAM,CAAC;EAElD,IAAIG,WAAW;EAIf,KAAK,IAAIC,MAAM,GAAGN,IAAI,EAAEM,MAAM,IAAIL,IAAI,EAAEK,MAAM,GAAGA,MAAM,GAAGT,IAAI,EAAE;IAE9DM,KAAK,GAAG,CAACG,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;IAEtB,MAAMC,CAAC,GAAG,CAACD,MAAM,GAAGZ,cAAc,CAAC,CAAC,CAAC,IAAIQ,MAAM,CAAC,CAAC,CAAC;IAClDC,KAAK,CAAC,CAAC,CAAC,GAAGI,CAAC,GAAGL,MAAM,CAAC,CAAC,CAAC,GAAGR,cAAc,CAAC,CAAC,CAAC;IAC5CS,KAAK,CAAC,CAAC,CAAC,GAAGI,CAAC,GAAGL,MAAM,CAAC,CAAC,CAAC,GAAGR,cAAc,CAAC,CAAC,CAAC;IAG5C,IAAIc,SAAS,CAACL,KAAK,EAAEL,MAAM,CAAC,EAAE;MAE5B,MAAMW,SAAS,GAAGvB,QAAQ,CAACwB,qBAAqB,CAACP,KAAK,CAAC;MAGvD,MAAMQ,WAAW,GAAGtB,gBAAgB,CAACoB,SAAS,EAAEN,KAAK,CAAC;MACtD,IAAIQ,WAAW,EAAE;QACfN,WAAW,GAAGM,WAAW;;;;EAK/B,OAAON,WAAW;AACpB;AAOA,MAAMG,SAAS,GAAG,SAAAA,CAChBL,KAAmB,EACnBL,MAAqB;EAErB,MAAM,CAACE,IAAI,EAAEC,IAAI,EAAEW,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,CAAC,GAAGjB,MAAM;EACnD,OACEK,KAAK,CAAC,CAAC,CAAC,GAAGH,IAAI,IACfG,KAAK,CAAC,CAAC,CAAC,GAAGF,IAAI,IACfE,KAAK,CAAC,CAAC,CAAC,GAAGS,IAAI,IACfT,KAAK,CAAC,CAAC,CAAC,GAAGU,IAAI,IACfV,KAAK,CAAC,CAAC,CAAC,GAAGW,IAAI,IACfX,KAAK,CAAC,CAAC,CAAC,GAAGY,IAAI;AAEnB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}