{"ast":null,"code":"import { Events } from '../../enums';\nimport { getEnabledElement, triggerEvent, eventTarget } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { roundNumber } from '../../utilities';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg } from '../../drawingSvg';\nimport { state } from '../../store';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor } from '../../cursors/elementCursor';\nclass AngleTool extends AnnotationTool {\n  constructor(toolProps = {}, defaultToolProps = {\n    supportedInteractionTypes: ['Mouse', 'Touch'],\n    configuration: {\n      shadow: true,\n      preventHandleOutsideImage: false,\n      getTextLines: defaultGetTextLines\n    }\n  }) {\n    super(toolProps, defaultToolProps);\n    this.addNewAnnotation = evt => {\n      if (this.angleStartedNotYetCompleted) {\n        return;\n      }\n      this.angleStartedNotYetCompleted = true;\n      const eventDetail = evt.detail;\n      const {\n        currentPoints,\n        element\n      } = eventDetail;\n      const worldPos = currentPoints.world;\n      const enabledElement = getEnabledElement(element);\n      const {\n        viewport,\n        renderingEngine\n      } = enabledElement;\n      hideElementCursor(element);\n      this.isDrawing = true;\n      const camera = viewport.getCamera();\n      const {\n        viewPlaneNormal,\n        viewUp\n      } = camera;\n      const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n      const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n      const annotation = {\n        highlighted: true,\n        invalidated: true,\n        metadata: {\n          toolName: this.getToolName(),\n          viewPlaneNormal: [...viewPlaneNormal],\n          viewUp: [...viewUp],\n          FrameOfReferenceUID,\n          referencedImageId\n        },\n        data: {\n          handles: {\n            points: [[...worldPos], [...worldPos]],\n            activeHandleIndex: null,\n            textBox: {\n              hasMoved: false,\n              worldPosition: [0, 0, 0],\n              worldBoundingBox: {\n                topLeft: [0, 0, 0],\n                topRight: [0, 0, 0],\n                bottomLeft: [0, 0, 0],\n                bottomRight: [0, 0, 0]\n              }\n            }\n          },\n          label: '',\n          cachedStats: {}\n        }\n      };\n      addAnnotation(annotation, element);\n      const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n      this.editData = {\n        annotation,\n        viewportIdsToRender,\n        handleIndex: 1,\n        movingTextBox: false,\n        newAnnotation: true,\n        hasMoved: false\n      };\n      this._activateDraw(element);\n      evt.preventDefault();\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      return annotation;\n    };\n    this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n      const enabledElement = getEnabledElement(element);\n      const {\n        viewport\n      } = enabledElement;\n      const {\n        data\n      } = annotation;\n      const [point1, point2, point3] = data.handles.points;\n      const canvasPoint1 = viewport.worldToCanvas(point1);\n      const canvasPoint2 = viewport.worldToCanvas(point2);\n      const line1 = {\n        start: {\n          x: canvasPoint1[0],\n          y: canvasPoint1[1]\n        },\n        end: {\n          x: canvasPoint2[0],\n          y: canvasPoint2[1]\n        }\n      };\n      const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n      if (distanceToPoint <= proximity) {\n        return true;\n      }\n      if (!point3) {\n        return false;\n      }\n      const canvasPoint3 = viewport.worldToCanvas(point3);\n      const line2 = {\n        start: {\n          x: canvasPoint2[0],\n          y: canvasPoint2[1]\n        },\n        end: {\n          x: canvasPoint3[0],\n          y: canvasPoint3[1]\n        }\n      };\n      const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n      if (distanceToPoint2 <= proximity) {\n        return true;\n      }\n      return false;\n    };\n    this.toolSelectedCallback = (evt, annotation) => {\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      annotation.highlighted = true;\n      const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n      this.editData = {\n        annotation,\n        viewportIdsToRender,\n        movingTextBox: false\n      };\n      this._activateModify(element);\n      hideElementCursor(element);\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      evt.preventDefault();\n    };\n    this._endCallback = evt => {\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        newAnnotation,\n        hasMoved\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (newAnnotation && !hasMoved) {\n        return;\n      }\n      if (this.angleStartedNotYetCompleted && data.handles.points.length === 2) {\n        this.editData.handleIndex = 2;\n        return;\n      }\n      this.angleStartedNotYetCompleted = false;\n      data.handles.activeHandleIndex = null;\n      this._deactivateModify(element);\n      this._deactivateDraw(element);\n      resetElementCursor(element);\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      if (this.isHandleOutsideImage && this.configuration.preventHandleOutsideImage) {\n        removeAnnotation(annotation.annotationUID);\n      }\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n      if (newAnnotation) {\n        const eventType = Events.ANNOTATION_COMPLETED;\n        const eventDetail = {\n          annotation\n        };\n        triggerEvent(eventTarget, eventType, eventDetail);\n      }\n      this.editData = null;\n      this.isDrawing = false;\n    };\n    this._dragCallback = evt => {\n      this.isDrawing = true;\n      const eventDetail = evt.detail;\n      const {\n        element\n      } = eventDetail;\n      const {\n        annotation,\n        viewportIdsToRender,\n        handleIndex,\n        movingTextBox\n      } = this.editData;\n      const {\n        data\n      } = annotation;\n      if (movingTextBox) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const {\n          textBox\n        } = data.handles;\n        const {\n          worldPosition\n        } = textBox;\n        worldPosition[0] += worldPosDelta[0];\n        worldPosition[1] += worldPosDelta[1];\n        worldPosition[2] += worldPosDelta[2];\n        textBox.hasMoved = true;\n      } else if (handleIndex === undefined) {\n        const {\n          deltaPoints\n        } = eventDetail;\n        const worldPosDelta = deltaPoints.world;\n        const points = data.handles.points;\n        points.forEach(point => {\n          point[0] += worldPosDelta[0];\n          point[1] += worldPosDelta[1];\n          point[2] += worldPosDelta[2];\n        });\n        annotation.invalidated = true;\n      } else {\n        const {\n          currentPoints\n        } = eventDetail;\n        const worldPos = currentPoints.world;\n        data.handles.points[handleIndex] = [...worldPos];\n        annotation.invalidated = true;\n      }\n      this.editData.hasMoved = true;\n      const enabledElement = getEnabledElement(element);\n      const {\n        renderingEngine\n      } = enabledElement;\n      triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    };\n    this.cancel = element => {\n      if (this.isDrawing) {\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const {\n          annotation,\n          viewportIdsToRender,\n          newAnnotation\n        } = this.editData;\n        const {\n          data\n        } = annotation;\n        annotation.highlighted = false;\n        data.handles.activeHandleIndex = null;\n        const enabledElement = getEnabledElement(element);\n        const {\n          renderingEngine\n        } = enabledElement;\n        triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n        if (newAnnotation) {\n          const eventType = Events.ANNOTATION_COMPLETED;\n          const eventDetail = {\n            annotation\n          };\n          triggerEvent(eventTarget, eventType, eventDetail);\n        }\n        this.editData = null;\n        this.angleStartedNotYetCompleted = false;\n        return annotation.annotationUID;\n      }\n    };\n    this._activateModify = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._deactivateModify = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._activateDraw = element => {\n      state.isInteractingWithTool = true;\n      element.addEventListener(Events.MOUSE_UP, this._endCallback);\n      element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.addEventListener(Events.TOUCH_END, this._endCallback);\n      element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this._deactivateDraw = element => {\n      state.isInteractingWithTool = false;\n      element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n      element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n      element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n      element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n      element.removeEventListener(Events.TOUCH_END, this._endCallback);\n      element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n    };\n    this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n      let renderStatus = false;\n      const {\n        viewport\n      } = enabledElement;\n      const {\n        element\n      } = viewport;\n      let annotations = getAnnotations(this.getToolName(), element);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n      if (!annotations?.length) {\n        return renderStatus;\n      }\n      const targetId = this.getTargetId(viewport);\n      const renderingEngine = viewport.getRenderingEngine();\n      const styleSpecifier = {\n        toolGroupId: this.toolGroupId,\n        toolName: this.getToolName(),\n        viewportId: enabledElement.viewport.id\n      };\n      for (let i = 0; i < annotations.length; i++) {\n        const annotation = annotations[i];\n        const {\n          annotationUID,\n          data\n        } = annotation;\n        const {\n          points,\n          activeHandleIndex\n        } = data.handles;\n        styleSpecifier.annotationUID = annotationUID;\n        const {\n          color,\n          lineWidth,\n          lineDash\n        } = this.getAnnotationStyle({\n          annotation,\n          styleSpecifier\n        });\n        const canvasCoordinates = points.map(p => viewport.worldToCanvas(p));\n        if (!data.cachedStats[targetId] || data.cachedStats[targetId].angle == null) {\n          data.cachedStats[targetId] = {\n            angle: null\n          };\n          this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n        } else if (annotation.invalidated) {\n          this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n        }\n        let activeHandleCanvasCoords;\n        if (!isAnnotationLocked(annotation) && !this.editData && activeHandleIndex !== null) {\n          activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (!viewport.getRenderingEngine()) {\n          console.warn('Rendering Engine has been destroyed');\n          return renderStatus;\n        }\n        if (activeHandleCanvasCoords) {\n          const handleGroupUID = '0';\n          drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n            color,\n            lineDash,\n            lineWidth\n          });\n        }\n        let lineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n          color,\n          width: lineWidth,\n          lineDash\n        });\n        renderStatus = true;\n        if (canvasCoordinates.length !== 3) {\n          return renderStatus;\n        }\n        lineUID = '2';\n        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], canvasCoordinates[2], {\n          color,\n          width: lineWidth,\n          lineDash\n        });\n        if (!data.cachedStats[targetId]?.angle) {\n          continue;\n        }\n        const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n        if (!options.visibility) {\n          data.handles.textBox = {\n            hasMoved: false,\n            worldPosition: [0, 0, 0],\n            worldBoundingBox: {\n              topLeft: [0, 0, 0],\n              topRight: [0, 0, 0],\n              bottomLeft: [0, 0, 0],\n              bottomRight: [0, 0, 0]\n            }\n          };\n          continue;\n        }\n        const textLines = this.configuration.getTextLines(data, targetId);\n        if (!data.handles.textBox.hasMoved) {\n          const canvasTextBoxCoords = canvasCoordinates[1];\n          data.handles.textBox.worldPosition = viewport.canvasToWorld(canvasTextBoxCoords);\n        }\n        const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n        const textBoxUID = '1';\n        const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n        const {\n          x: left,\n          y: top,\n          width,\n          height\n        } = boundingBox;\n        data.handles.textBox.worldBoundingBox = {\n          topLeft: viewport.canvasToWorld([left, top]),\n          topRight: viewport.canvasToWorld([left + width, top]),\n          bottomLeft: viewport.canvasToWorld([left, top + height]),\n          bottomRight: viewport.canvasToWorld([left + width, top + height])\n        };\n      }\n      return renderStatus;\n    };\n    this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, {\n      trailing: true\n    });\n  }\n  handleSelectedCallback(evt, annotation, handle) {\n    const eventDetail = evt.detail;\n    const {\n      element\n    } = eventDetail;\n    const {\n      data\n    } = annotation;\n    annotation.highlighted = true;\n    let movingTextBox = false;\n    let handleIndex;\n    if (handle.worldPosition) {\n      movingTextBox = true;\n    } else {\n      handleIndex = data.handles.points.findIndex(p => p === handle);\n    }\n    const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n    this.editData = {\n      annotation,\n      viewportIdsToRender,\n      handleIndex,\n      movingTextBox\n    };\n    this._activateModify(element);\n    hideElementCursor(element);\n    const enabledElement = getEnabledElement(element);\n    const {\n      renderingEngine\n    } = enabledElement;\n    triggerAnnotationRenderForViewportIds(renderingEngine, viewportIdsToRender);\n    evt.preventDefault();\n  }\n  _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n    const data = annotation.data;\n    const {\n      viewportId,\n      renderingEngineId\n    } = enabledElement;\n    if (data.handles.points.length !== 3) {\n      return;\n    }\n    const worldPos1 = data.handles.points[0];\n    const worldPos2 = data.handles.points[1];\n    const worldPos3 = data.handles.points[2];\n    const {\n      cachedStats\n    } = data;\n    const targetIds = Object.keys(cachedStats);\n    for (let i = 0; i < targetIds.length; i++) {\n      const targetId = targetIds[i];\n      const angle = angleBetweenLines([worldPos1, worldPos2], [worldPos2, worldPos3]);\n      cachedStats[targetId] = {\n        angle: isNaN(angle) ? 'Incomplete Angle' : angle\n      };\n    }\n    annotation.invalidated = false;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n      annotation,\n      viewportId,\n      renderingEngineId\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n    return cachedStats;\n  }\n}\nfunction defaultGetTextLines(data, targetId) {\n  const cachedVolumeStats = data.cachedStats[targetId];\n  const {\n    angle\n  } = cachedVolumeStats;\n  if (angle === undefined) {\n    return;\n  }\n  const textLines = [`${roundNumber(angle)} ${String.fromCharCode(176)}`];\n  return textLines;\n}\nAngleTool.toolName = 'Angle';\nexport default AngleTool;","map":{"version":3,"names":["Events","getEnabledElement","triggerEvent","eventTarget","AnnotationTool","throttle","addAnnotation","getAnnotations","removeAnnotation","isAnnotationLocked","lineSegment","angleBetweenLines","roundNumber","drawHandles","drawHandlesSvg","drawLine","drawLineSvg","drawLinkedTextBox","drawLinkedTextBoxSvg","state","getViewportIdsWithToolToRender","triggerAnnotationRenderForViewportIds","resetElementCursor","hideElementCursor","AngleTool","constructor","toolProps","defaultToolProps","supportedInteractionTypes","configuration","shadow","preventHandleOutsideImage","getTextLines","defaultGetTextLines","addNewAnnotation","evt","angleStartedNotYetCompleted","eventDetail","detail","currentPoints","element","worldPos","world","enabledElement","viewport","renderingEngine","isDrawing","camera","getCamera","viewPlaneNormal","viewUp","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getFrameOfReferenceUID","annotation","highlighted","invalidated","metadata","toolName","getToolName","data","handles","points","activeHandleIndex","textBox","hasMoved","worldPosition","worldBoundingBox","topLeft","topRight","bottomLeft","bottomRight","label","cachedStats","viewportIdsToRender","editData","handleIndex","movingTextBox","newAnnotation","_activateDraw","preventDefault","isPointNearTool","canvasCoords","proximity","point1","point2","point3","canvasPoint1","worldToCanvas","canvasPoint2","line1","start","x","y","end","distanceToPoint","canvasPoint3","line2","distanceToPoint2","toolSelectedCallback","_activateModify","_endCallback","length","_deactivateModify","_deactivateDraw","isHandleOutsideImage","annotationUID","eventType","ANNOTATION_COMPLETED","_dragCallback","deltaPoints","worldPosDelta","undefined","forEach","point","cancel","isInteractingWithTool","addEventListener","MOUSE_UP","MOUSE_DRAG","MOUSE_CLICK","TOUCH_TAP","TOUCH_END","TOUCH_DRAG","removeEventListener","MOUSE_MOVE","renderAnnotation","svgDrawingHelper","renderStatus","annotations","filterInteractableAnnotationsForElement","targetId","getTargetId","getRenderingEngine","styleSpecifier","toolGroupId","viewportId","id","i","color","lineWidth","lineDash","getAnnotationStyle","canvasCoordinates","map","p","angle","_calculateCachedStats","_throttledCalculateCachedStats","activeHandleCanvasCoords","console","warn","handleGroupUID","lineUID","width","options","getLinkedTextBoxStyle","visibility","textLines","canvasTextBoxCoords","canvasToWorld","textBoxPosition","textBoxUID","boundingBox","left","top","height","trailing","handleSelectedCallback","handle","findIndex","renderingEngineId","worldPos1","worldPos2","worldPos3","targetIds","Object","keys","isNaN","ANNOTATION_MODIFIED","cachedVolumeStats","String","fromCharCode"],"sources":["../../../../src/tools/annotation/AngleTool.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}