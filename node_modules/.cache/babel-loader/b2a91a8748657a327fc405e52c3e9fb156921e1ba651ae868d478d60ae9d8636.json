{"ast":null,"code":"import { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, touchToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher } from '../eventDispatchers';\nimport { state } from './state';\nimport { annotationRenderingEngine } from '../utilities/triggerAnnotationRender';\nexport default function addEnabledElement(evt) {\n  const {\n    element,\n    viewportId\n  } = evt.detail;\n  const svgLayer = _createSvgAnnotationLayer(viewportId);\n  _setSvgNodeCache(element);\n  _appendChild(svgLayer, element);\n  annotationRenderingEngine.addViewportElement(viewportId, element);\n  mouseEventListeners.enable(element);\n  wheelEventListener.enable(element);\n  touchEventListeners.enable(element);\n  keyEventListener.enable(element);\n  imageChangeEventListener.enable(element);\n  imageRenderedEventDispatcher.enable(element);\n  cameraModifiedEventDispatcher.enable(element);\n  imageSpacingCalibratedEventDispatcher.enable(element);\n  mouseToolEventDispatcher.enable(element);\n  keyboardToolEventDispatcher.enable(element);\n  touchToolEventDispatcher.enable(element);\n  state.enabledElements.push(element);\n}\nfunction _createSvgAnnotationLayer(viewportId) {\n  const svgns = 'http://www.w3.org/2000/svg';\n  const svgLayer = document.createElementNS(svgns, 'svg');\n  const svgLayerId = `svg-layer-${viewportId}`;\n  svgLayer.classList.add('svg-layer');\n  svgLayer.setAttribute('id', svgLayerId);\n  svgLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n  svgLayer.style.width = '100%';\n  svgLayer.style.height = '100%';\n  svgLayer.style.pointerEvents = 'none';\n  svgLayer.style.position = 'absolute';\n  const defs = document.createElementNS(svgns, 'defs');\n  const filter = document.createElementNS(svgns, 'filter');\n  const feOffset = document.createElementNS(svgns, 'feOffset');\n  const feColorMatrix = document.createElementNS(svgns, 'feColorMatrix');\n  const feBlend = document.createElementNS(svgns, 'feBlend');\n  filter.setAttribute('id', `shadow-${svgLayerId}`);\n  filter.setAttribute('filterUnits', 'userSpaceOnUse');\n  feOffset.setAttribute('result', 'offOut');\n  feOffset.setAttribute('in', 'SourceGraphic');\n  feOffset.setAttribute('dx', '0.5');\n  feOffset.setAttribute('dy', '0.5');\n  feColorMatrix.setAttribute('result', 'matrixOut');\n  feColorMatrix.setAttribute('in', 'offOut');\n  feColorMatrix.setAttribute('in2', 'matrix');\n  feColorMatrix.setAttribute('values', '0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0');\n  feBlend.setAttribute('in', 'SourceGraphic');\n  feBlend.setAttribute('in2', 'matrixOut');\n  feBlend.setAttribute('mode', 'normal');\n  filter.appendChild(feOffset);\n  filter.appendChild(feColorMatrix);\n  filter.appendChild(feBlend);\n  defs.appendChild(filter);\n  svgLayer.appendChild(defs);\n  return svgLayer;\n}\nfunction _setSvgNodeCache(element) {\n  const {\n    viewportUid: viewportId,\n    renderingEngineUid: renderingEngineId\n  } = element.dataset;\n  const elementHash = `${viewportId}:${renderingEngineId}`;\n  state.svgNodeCache[elementHash] = {};\n}\nfunction _appendChild(newNode, referenceNode) {\n  referenceNode.querySelector('div.viewport-element').appendChild(newNode);\n}","map":{"version":3,"names":["mouseEventListeners","wheelEventListener","touchEventListeners","keyEventListener","imageChangeEventListener","imageRenderedEventDispatcher","cameraModifiedEventDispatcher","mouseToolEventDispatcher","touchToolEventDispatcher","keyboardToolEventDispatcher","imageSpacingCalibratedEventDispatcher","state","annotationRenderingEngine","addEnabledElement","evt","element","viewportId","detail","svgLayer","_createSvgAnnotationLayer","_setSvgNodeCache","_appendChild","addViewportElement","enable","enabledElements","push","svgns","document","createElementNS","svgLayerId","classList","add","setAttribute","style","width","height","pointerEvents","position","defs","filter","feOffset","feColorMatrix","feBlend","appendChild","viewportUid","renderingEngineUid","renderingEngineId","dataset","elementHash","svgNodeCache","newNode","referenceNode","querySelector"],"sources":["../../../src/store/addEnabledElement.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}