{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport cache from '../cache/cache';\nimport { ImageVolume } from '../cache';\nimport Events from '../enums/Events';\nimport eventTarget from '../eventTarget';\nimport { genericMetadataProvider, getBufferConfiguration, triggerEvent, uuidv4 } from '../utilities';\nimport imageLoadPoolManager from '../requestPool/imageLoadPoolManager';\nimport { metaData } from '../';\nconst imageLoaders = {};\nlet unknownImageLoader;\nfunction loadImageFromImageLoader(imageId, options) {\n  const colonIndex = imageId.indexOf(':');\n  const scheme = imageId.substring(0, colonIndex);\n  const loader = imageLoaders[scheme];\n  if (loader === undefined || loader === null) {\n    if (unknownImageLoader !== undefined) {\n      return unknownImageLoader(imageId);\n    }\n    throw new Error('loadImageFromImageLoader: no image loader for imageId');\n  }\n  const imageLoadObject = loader(imageId, options);\n  imageLoadObject.promise.then(function (image) {\n    triggerEvent(eventTarget, Events.IMAGE_LOADED, {\n      image\n    });\n  }, function (error) {\n    const errorObject = {\n      imageId,\n      error\n    };\n    triggerEvent(eventTarget, Events.IMAGE_LOAD_FAILED, errorObject);\n  });\n  return imageLoadObject;\n}\nfunction loadImageFromCacheOrVolume(imageId, options) {\n  let imageLoadObject = cache.getImageLoadObject(imageId);\n  if (imageLoadObject !== undefined) {\n    return imageLoadObject;\n  }\n  const cachedVolumeInfo = cache.getVolumeContainingImageId(imageId);\n  if (cachedVolumeInfo?.volume?.loadStatus?.loaded) {\n    const {\n      volume,\n      imageIdIndex\n    } = cachedVolumeInfo;\n    if (volume instanceof ImageVolume) {\n      imageLoadObject = volume.convertToCornerstoneImage(imageId, imageIdIndex);\n    }\n    return imageLoadObject;\n  }\n  const cachedImage = cache.getCachedImageBasedOnImageURI(imageId);\n  if (cachedImage) {\n    imageLoadObject = cachedImage.imageLoadObject;\n    return imageLoadObject;\n  }\n  imageLoadObject = loadImageFromImageLoader(imageId, options);\n  return imageLoadObject;\n}\nexport function loadImage(imageId, options = {\n  priority: 0,\n  requestType: 'prefetch'\n}) {\n  if (imageId === undefined) {\n    throw new Error('loadImage: parameter imageId must not be undefined');\n  }\n  return loadImageFromCacheOrVolume(imageId, options).promise;\n}\nexport function loadAndCacheImage(imageId, options = {\n  priority: 0,\n  requestType: 'prefetch'\n}) {\n  if (imageId === undefined) {\n    throw new Error('loadAndCacheImage: parameter imageId must not be undefined');\n  }\n  const imageLoadObject = loadImageFromCacheOrVolume(imageId, options);\n  if (!cache.getImageLoadObject(imageId)) {\n    cache.putImageLoadObject(imageId, imageLoadObject).catch(err => {\n      console.warn(err);\n    });\n  }\n  return imageLoadObject.promise;\n}\nexport function loadAndCacheImages(imageIds, options = {\n  priority: 0,\n  requestType: 'prefetch'\n}) {\n  if (!imageIds || imageIds.length === 0) {\n    throw new Error('loadAndCacheImages: parameter imageIds must be list of image Ids');\n  }\n  const allPromises = imageIds.map(imageId => {\n    return loadAndCacheImage(imageId, options);\n  });\n  return allPromises;\n}\nexport function createAndCacheDerivedImage(referencedImageId, options = {}, preventCache = false) {\n  if (referencedImageId === undefined) {\n    throw new Error('createAndCacheDerivedImage: parameter imageId must not be undefined');\n  }\n  if (options.imageId === undefined) {\n    options.imageId = `derived:${uuidv4()}`;\n  }\n  const imagePlaneModule = metaData.get('imagePlaneModule', referencedImageId);\n  const length = imagePlaneModule.rows * imagePlaneModule.columns;\n  const {\n    TypedArrayConstructor\n  } = getBufferConfiguration(options.targetBufferType, length);\n  const imageScalarData = new TypedArrayConstructor(length);\n  const derivedImageId = options.imageId;\n  ['imagePixelModule', 'imagePlaneModule', 'generalSeriesModule'].forEach(type => {\n    genericMetadataProvider.add(derivedImageId, {\n      type,\n      metadata: metaData.get(type, referencedImageId)\n    });\n  });\n  const localImage = createAndCacheLocalImage({\n    scalarData: imageScalarData\n  }, options.imageId, true);\n  const imageLoadObject = {\n    promise: Promise.resolve(localImage)\n  };\n  if (!preventCache) {\n    cache.putImageLoadObject(derivedImageId, imageLoadObject);\n  }\n  return imageLoadObject.promise;\n}\nexport function createAndCacheDerivedImages(referencedImageIds, options = {}) {\n  if (referencedImageIds?.length === 0) {\n    throw new Error('createAndCacheDerivedImages: parameter imageIds must be list of image Ids');\n  }\n  const derivedImageIds = [];\n  const allPromises = referencedImageIds.map(referencedImageId => {\n    const newOptions = {\n      imageId: options.getDerivedImageId ? options.getDerivedImageId(referencedImageId) : `derived:${uuidv4()}`,\n      ...options\n    };\n    derivedImageIds.push(newOptions.imageId);\n    return createAndCacheDerivedImage(referencedImageId, newOptions);\n  });\n  return {\n    imageIds: derivedImageIds,\n    promises: allPromises\n  };\n}\nexport function createAndCacheLocalImage(options, imageId, preventCache = false) {\n  const imagePlaneModule = metaData.get('imagePlaneModule', imageId);\n  const length = imagePlaneModule.rows * imagePlaneModule.columns;\n  const image = {\n    imageId: imageId,\n    intercept: 0,\n    windowCenter: 0,\n    windowWidth: 0,\n    color: false,\n    numComps: 1,\n    slope: 1,\n    minPixelValue: 0,\n    maxPixelValue: 255,\n    voiLUTFunction: undefined,\n    rows: imagePlaneModule.rows,\n    columns: imagePlaneModule.columns,\n    getCanvas: undefined,\n    height: imagePlaneModule.rows,\n    width: imagePlaneModule.columns,\n    rgba: undefined,\n    columnPixelSpacing: imagePlaneModule.columnPixelSpacing,\n    rowPixelSpacing: imagePlaneModule.rowPixelSpacing,\n    invert: false\n  };\n  if (options.scalarData) {\n    const imageScalarData = options.scalarData;\n    if (!(imageScalarData instanceof Uint8Array || imageScalarData instanceof Float32Array || imageScalarData instanceof Uint16Array || imageScalarData instanceof Int16Array)) {\n      throw new Error('To use createLocalVolume you should pass scalarData of type Uint8Array, Uint16Array, Int16Array or Float32Array');\n    }\n    image.sizeInBytes = imageScalarData.byteLength;\n    image.getPixelData = () => imageScalarData;\n  } else {\n    const {\n      numBytes,\n      TypedArrayConstructor\n    } = getBufferConfiguration(options.targetBufferType, length);\n    const imageScalarData = new TypedArrayConstructor(length);\n    image.sizeInBytes = numBytes;\n    image.getPixelData = () => imageScalarData;\n  }\n  const imageLoadObject = {\n    promise: Promise.resolve(image)\n  };\n  if (!preventCache) {\n    cache.putImageLoadObject(image.imageId, imageLoadObject);\n  }\n  return image;\n}\nexport function cancelLoadImage(imageId) {\n  const filterFunction = ({\n    additionalDetails\n  }) => {\n    if (additionalDetails.imageId) {\n      return additionalDetails.imageId !== imageId;\n    }\n    return true;\n  };\n  imageLoadPoolManager.filterRequests(filterFunction);\n  const imageLoadObject = cache.getImageLoadObject(imageId);\n  if (imageLoadObject) {\n    imageLoadObject.cancelFn();\n  }\n}\nexport function cancelLoadImages(imageIds) {\n  imageIds.forEach(imageId => cancelLoadImage(imageId));\n}\nexport function cancelLoadAll() {\n  const requestPool = imageLoadPoolManager.getRequestPool();\n  Object.keys(requestPool).forEach(type => {\n    const requests = requestPool[type];\n    Object.keys(requests).forEach(priority => {\n      const requestDetails = requests[priority].pop();\n      const additionalDetails = requestDetails.additionalDetails;\n      const {\n        imageId,\n        volumeId\n      } = additionalDetails;\n      let loadObject;\n      if (imageId) {\n        loadObject = cache.getImageLoadObject(imageId);\n      } else if (volumeId) {\n        loadObject = cache.getVolumeLoadObject(volumeId);\n      }\n      if (loadObject) {\n        loadObject.cancel();\n      }\n    });\n    imageLoadPoolManager.clearRequestStack(type);\n  });\n}\nexport function registerImageLoader(scheme, imageLoader) {\n  imageLoaders[scheme] = imageLoader;\n}\nexport function registerUnknownImageLoader(imageLoader) {\n  const oldImageLoader = unknownImageLoader;\n  unknownImageLoader = imageLoader;\n  return oldImageLoader;\n}\nexport function unregisterAllImageLoaders() {\n  Object.keys(imageLoaders).forEach(imageLoader => delete imageLoaders[imageLoader]);\n  unknownImageLoader = undefined;\n}\nexport function createAndCacheDerivedSegmentationImages(referencedImageIds, options = {\n  targetBufferType: 'Uint8Array'\n}) {\n  return createAndCacheDerivedImages(referencedImageIds, options);\n}\nexport function createAndCacheDerivedSegmentationImage(referencedImageId, options = {\n  targetBufferType: 'Uint8Array'\n}) {\n  return createAndCacheDerivedImage(referencedImageId, options);\n}","map":{"version":3,"names":["cache","ImageVolume","Events","eventTarget","genericMetadataProvider","getBufferConfiguration","triggerEvent","uuidv4","imageLoadPoolManager","metaData","imageLoaders","unknownImageLoader","loadImageFromImageLoader","imageId","options","colonIndex","indexOf","scheme","substring","loader","undefined","Error","imageLoadObject","promise","then","image","IMAGE_LOADED","error","errorObject","IMAGE_LOAD_FAILED","loadImageFromCacheOrVolume","getImageLoadObject","cachedVolumeInfo","getVolumeContainingImageId","volume","loadStatus","loaded","imageIdIndex","convertToCornerstoneImage","cachedImage","getCachedImageBasedOnImageURI","loadImage","priority","requestType","loadAndCacheImage","putImageLoadObject","catch","err","console","warn","loadAndCacheImages","imageIds","length","allPromises","map","createAndCacheDerivedImage","referencedImageId","preventCache","imagePlaneModule","get","rows","columns","TypedArrayConstructor","targetBufferType","imageScalarData","derivedImageId","forEach","type","add","metadata","localImage","createAndCacheLocalImage","scalarData","Promise","resolve","createAndCacheDerivedImages","referencedImageIds","derivedImageIds","newOptions","getDerivedImageId","push","promises","intercept","windowCenter","windowWidth","color","numComps","slope","minPixelValue","maxPixelValue","voiLUTFunction","getCanvas","height","width","rgba","columnPixelSpacing","rowPixelSpacing","invert","Uint8Array","Float32Array","Uint16Array","Int16Array","sizeInBytes","byteLength","getPixelData","numBytes","cancelLoadImage","filterFunction","additionalDetails","filterRequests","cancelFn","cancelLoadImages","cancelLoadAll","requestPool","getRequestPool","Object","keys","requests","requestDetails","pop","volumeId","loadObject","getVolumeLoadObject","cancel","clearRequestStack","registerImageLoader","imageLoader","registerUnknownImageLoader","oldImageLoader","unregisterAllImageLoaders","createAndCacheDerivedSegmentationImages","createAndCacheDerivedSegmentationImage"],"sources":["../../../src/loaders/imageLoader.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}