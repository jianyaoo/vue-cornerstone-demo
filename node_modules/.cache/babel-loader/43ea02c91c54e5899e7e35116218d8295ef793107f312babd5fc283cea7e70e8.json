{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nimport extend2DBoundingBoxInViewAxis from '../boundingBox/extend2DBoundingBoxInViewAxis';\nfunction getBoundsIJKFromRectangleAnnotations(annotations, referenceVolume, options = {}) {\n  const AllBoundsIJK = [];\n  annotations.forEach(annotation => {\n    const {\n      data\n    } = annotation;\n    const {\n      points\n    } = data.handles;\n    const {\n      imageData,\n      dimensions\n    } = referenceVolume;\n    let pointsToUse = points;\n    if (data.cachedStats?.projectionPoints) {\n      const {\n        projectionPoints\n      } = data.cachedStats;\n      pointsToUse = [].concat(...projectionPoints);\n    }\n    const rectangleCornersIJK = pointsToUse.map(world => csUtils.transformWorldToIndex(imageData, world));\n    let boundsIJK = getBoundingBoxAroundShapeIJK(rectangleCornersIJK, dimensions);\n    if (options.numSlicesToProject && !data.cachedStats?.projectionPoints) {\n      boundsIJK = extend2DBoundingBoxInViewAxis(boundsIJK, options.numSlicesToProject);\n    }\n    AllBoundsIJK.push(boundsIJK);\n  });\n  if (AllBoundsIJK.length === 1) {\n    return AllBoundsIJK[0];\n  }\n  const boundsIJK = AllBoundsIJK.reduce((accumulator, currentValue) => {\n    return {\n      iMin: Math.min(accumulator.iMin, currentValue.iMin),\n      jMin: Math.min(accumulator.jMin, currentValue.jMin),\n      kMin: Math.min(accumulator.kMin, currentValue.kMin),\n      iMax: Math.max(accumulator.iMax, currentValue.iMax),\n      jMax: Math.max(accumulator.jMax, currentValue.jMax),\n      kMax: Math.max(accumulator.kMax, currentValue.kMax)\n    };\n  }, {\n    iMin: Infinity,\n    jMin: Infinity,\n    kMin: Infinity,\n    iMax: -Infinity,\n    jMax: -Infinity,\n    kMax: -Infinity\n  });\n  return boundsIJK;\n}\nexport default getBoundsIJKFromRectangleAnnotations;","map":{"version":3,"names":["utilities","csUtils","getBoundingBoxAroundShapeIJK","extend2DBoundingBoxInViewAxis","getBoundsIJKFromRectangleAnnotations","annotations","referenceVolume","options","AllBoundsIJK","forEach","annotation","data","points","handles","imageData","dimensions","pointsToUse","cachedStats","projectionPoints","concat","rectangleCornersIJK","map","world","transformWorldToIndex","boundsIJK","numSlicesToProject","push","length","reduce","accumulator","currentValue","iMin","Math","min","jMin","kMin","iMax","max","jMax","kMax","Infinity"],"sources":["../../../../src/utilities/rectangleROITool/getBoundsIJKFromRectangleAnnotations.ts"],"sourcesContent":[null],"mappings":";AAAA,SAASA,SAAS,IAAIC,OAAO,QAAQ,qBAAqB;AAE1D,SAASC,4BAA4B,QAAQ,0CAA0C;AACvF,OAAOC,6BAA6B,MAAM,8CAA8C;AAMxF,SAASC,oCAAoCA,CAC3CC,WAAW,EACXC,eAAe,EACfC,OAAA,GAAU,EAAa;EAEvB,MAAMC,YAAY,GAAG,EAAE;EACvBH,WAAW,CAACI,OAAO,CAAEC,UAAU,IAAI;IACjC,MAAM;MAAEC;IAAI,CAAE,GAAGD,UAAU;IAC3B,MAAM;MAAEE;IAAM,CAAE,GAAGD,IAAI,CAACE,OAAO;IAE/B,MAAM;MAAEC,SAAS;MAAEC;IAAU,CAAE,GAAGT,eAAe;IAEjD,IAAIU,WAAW,GAAGJ,MAAM;IAExB,IAAID,IAAI,CAACM,WAAW,EAAEC,gBAAgB,EAAE;MACtC,MAAM;QAAEA;MAAgB,CAAE,GAAGP,IAAI,CAACM,WAAW;MAC7CD,WAAW,GAAG,EAAE,CAACG,MAAM,CAAC,GAAGD,gBAAgB,CAAC;;IAG9C,MAAME,mBAAmB,GAAGJ,WAAW,CAACK,GAAG,CACxCC,KAAK,IAAKrB,OAAO,CAACsB,qBAAqB,CAACT,SAAS,EAAEQ,KAAK,CAAiB,CAC3E;IACD,IAAIE,SAAS,GAAGtB,4BAA4B,CAC1CkB,mBAAmB,EACnBL,UAAU,CACX;IAID,IAAIR,OAAO,CAACkB,kBAAkB,IAAI,CAACd,IAAI,CAACM,WAAW,EAAEC,gBAAgB,EAAE;MACrEM,SAAS,GAAGrB,6BAA6B,CACvCqB,SAAS,EACTjB,OAAO,CAACkB,kBAAkB,CAC3B;;IAGHjB,YAAY,CAACkB,IAAI,CAACF,SAAS,CAAC;EAC9B,CAAC,CAAC;EAEF,IAAIhB,YAAY,CAACmB,MAAM,KAAK,CAAC,EAAE;IAC7B,OAAOnB,YAAY,CAAC,CAAC,CAAC;;EAKxB,MAAMgB,SAAS,GAAGhB,YAAY,CAACoB,MAAM,CACnC,CAACC,WAAW,EAAEC,YAAY,KAAI;IAC5B,OAAO;MACLC,IAAI,EAAEC,IAAI,CAACC,GAAG,CAACJ,WAAW,CAACE,IAAI,EAAED,YAAY,CAACC,IAAI,CAAC;MACnDG,IAAI,EAAEF,IAAI,CAACC,GAAG,CAACJ,WAAW,CAACK,IAAI,EAAEJ,YAAY,CAACI,IAAI,CAAC;MACnDC,IAAI,EAAEH,IAAI,CAACC,GAAG,CAACJ,WAAW,CAACM,IAAI,EAAEL,YAAY,CAACK,IAAI,CAAC;MACnDC,IAAI,EAAEJ,IAAI,CAACK,GAAG,CAACR,WAAW,CAACO,IAAI,EAAEN,YAAY,CAACM,IAAI,CAAC;MACnDE,IAAI,EAAEN,IAAI,CAACK,GAAG,CAACR,WAAW,CAACS,IAAI,EAAER,YAAY,CAACQ,IAAI,CAAC;MACnDC,IAAI,EAAEP,IAAI,CAACK,GAAG,CAACR,WAAW,CAACU,IAAI,EAAET,YAAY,CAACS,IAAI;KACnD;EACH,CAAC,EACD;IACER,IAAI,EAAES,QAAQ;IACdN,IAAI,EAAEM,QAAQ;IACdL,IAAI,EAAEK,QAAQ;IACdJ,IAAI,EAAE,CAACI,QAAQ;IACfF,IAAI,EAAE,CAACE,QAAQ;IACfD,IAAI,EAAE,CAACC;GACR,CACF;EAED,OAAOhB,SAAS;AAClB;AAEA,eAAepB,oCAAoC"},"metadata":{},"sourceType":"module","externalDependencies":[]}