import StrategyCallbacks from '../../../../enums/StrategyCallbacks';
export default {
    [StrategyCallbacks.Initialize]: (operationData) => {
        const { centerIJK, strategySpecificConfiguration, segmentationVoxelManager: segmentationVoxelManager, imageVoxelManager: imageVoxelManager, segmentIndex, } = operationData;
        const { THRESHOLD } = strategySpecificConfiguration;
        if (!THRESHOLD?.isDynamic || !centerIJK || !segmentIndex) {
            return;
        }
        const { boundsIJK } = segmentationVoxelManager;
        const { threshold: oldThreshold, dynamicRadius = 0 } = THRESHOLD;
        const useDelta = oldThreshold ? 0 : dynamicRadius;
        const nestedBounds = boundsIJK.map((ijk, idx) => {
            const [min, max] = ijk;
            return [
                Math.max(min, centerIJK[idx] - useDelta),
                Math.min(max, centerIJK[idx] + useDelta),
            ];
        });
        const threshold = oldThreshold || [Infinity, -Infinity];
        const callback = ({ value }) => {
            threshold[0] = Math.min(value, threshold[0]);
            threshold[1] = Math.max(value, threshold[1]);
        };
        imageVoxelManager.forEach(callback, { boundsIJK: nestedBounds });
        operationData.strategySpecificConfiguration.THRESHOLD.threshold = threshold;
    },
    [StrategyCallbacks.OnInteractionStart]: (operationData) => {
        const { strategySpecificConfiguration, preview } = operationData;
        if (!strategySpecificConfiguration?.THRESHOLD?.isDynamic && !preview) {
            return;
        }
        strategySpecificConfiguration.THRESHOLD.threshold = null;
    },
};
//# sourceMappingURL=dynamicThreshold.js.map