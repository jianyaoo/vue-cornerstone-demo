import { cache, utilities } from '@cornerstonejs/core';
import { isVolumeSegmentation } from './stackVolumeCheck';
const { VoxelManager } = utilities;
function getStrategyData({ operationData, viewport }) {
    let segmentationImageData, segmentationScalarData, imageScalarData;
    let dimensions;
    if (isVolumeSegmentation(operationData)) {
        const { volumeId, referencedVolumeId } = operationData;
        const segmentationVolume = cache.getVolume(volumeId);
        const imageVolume = cache.getVolume(referencedVolumeId);
        if (!segmentationVolume || !imageVolume) {
            return;
        }
        ({ imageData: segmentationImageData } = segmentationVolume);
        segmentationScalarData = segmentationVolume.getScalarData();
        imageScalarData = imageVolume.getScalarData();
        dimensions = imageVolume.dimensions;
    }
    else {
        const { imageIdReferenceMap, segmentationRepresentationUID } = operationData;
        if (!imageIdReferenceMap) {
            return;
        }
        const currentImageId = viewport.getCurrentImageId();
        if (!currentImageId) {
            return;
        }
        const actor = viewport.getActor(segmentationRepresentationUID);
        segmentationImageData = actor.actor.getMapper().getInputData();
        const currentSegmentationImageId = imageIdReferenceMap.get(currentImageId);
        const segmentationImage = cache.getImage(currentSegmentationImageId);
        segmentationScalarData = segmentationImage.getPixelData();
        const image = cache.getImage(currentImageId);
        imageScalarData = image.getPixelData();
        dimensions = [image.columns, image.rows, 1];
    }
    return {
        segmentationImageData,
        segmentationScalarData,
        segmentationVoxelManager: VoxelManager.createVolumeVoxelManager(dimensions, segmentationScalarData),
        imageScalarData,
        imageVoxelManager: VoxelManager.createVolumeVoxelManager(dimensions, imageScalarData),
    };
}
export { getStrategyData };
//# sourceMappingURL=getStrategyData.js.map