{"ast":null,"code":"import { getEnabledElementByIds, VolumeViewport } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nimport { scroll } from '../utilities';\nclass StackScrollTool extends BaseTool {\n  constructor(toolProps = {}, defaultToolProps = {\n    supportedInteractionTypes: ['Mouse', 'Touch'],\n    configuration: {\n      invert: false,\n      debounceIfNotLoaded: true,\n      loop: false\n    }\n  }) {\n    super(toolProps, defaultToolProps);\n    this.deltaY = 1;\n  }\n  mouseDragCallback(evt) {\n    this._dragCallback(evt);\n  }\n  touchDragCallback(evt) {\n    this._dragCallback(evt);\n  }\n  _dragCallback(evt) {\n    const {\n      deltaPoints,\n      viewportId,\n      renderingEngineId\n    } = evt.detail;\n    const {\n      viewport\n    } = getEnabledElementByIds(viewportId, renderingEngineId);\n    const targetId = this.getTargetId(viewport);\n    const {\n      debounceIfNotLoaded,\n      invert,\n      loop\n    } = this.configuration;\n    const deltaPointY = deltaPoints.canvas[1];\n    let volumeId;\n    if (viewport instanceof VolumeViewport) {\n      volumeId = targetId.split('volumeId:')[1];\n    }\n    const pixelsPerImage = this._getPixelPerImage(viewport);\n    const deltaY = deltaPointY + this.deltaY;\n    if (!pixelsPerImage) {\n      return;\n    }\n    if (Math.abs(deltaY) >= pixelsPerImage) {\n      const imageIdIndexOffset = Math.round(deltaY / pixelsPerImage);\n      scroll(viewport, {\n        delta: invert ? -imageIdIndexOffset : imageIdIndexOffset,\n        volumeId,\n        debounceLoading: debounceIfNotLoaded,\n        loop: loop\n      });\n      this.deltaY = deltaY % pixelsPerImage;\n    } else {\n      this.deltaY = deltaY;\n    }\n  }\n  _getPixelPerImage(viewport) {\n    const {\n      element\n    } = viewport;\n    const numberOfSlices = viewport.getNumberOfSlices();\n    return Math.max(2, element.offsetHeight / Math.max(numberOfSlices, 8));\n  }\n}\nStackScrollTool.toolName = 'StackScroll';\nexport default StackScrollTool;","map":{"version":3,"names":["getEnabledElementByIds","VolumeViewport","BaseTool","scroll","StackScrollTool","constructor","toolProps","defaultToolProps","supportedInteractionTypes","configuration","invert","debounceIfNotLoaded","loop","deltaY","mouseDragCallback","evt","_dragCallback","touchDragCallback","deltaPoints","viewportId","renderingEngineId","detail","viewport","targetId","getTargetId","deltaPointY","canvas","volumeId","split","pixelsPerImage","_getPixelPerImage","Math","abs","imageIdIndexOffset","round","delta","debounceLoading","element","numberOfSlices","getNumberOfSlices","max","offsetHeight","toolName"],"sources":["../../../src/tools/StackScrollTool.ts"],"sourcesContent":[null],"mappings":"AAAA,SAASA,sBAAsB,EAAEC,cAAc,QAAQ,qBAAqB;AAC5E,SAASC,QAAQ,QAAQ,QAAQ;AACjC,SAASC,MAAM,QAAQ,cAAc;AAOrC,MAAMC,eAAgB,SAAQF,QAAQ;EAGpCG,YACEC,SAAA,GAA6B,EAAE,EAC/BC,gBAAA,GAA8B;IAC5BC,yBAAyB,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;IAC7CC,aAAa,EAAE;MACbC,MAAM,EAAE,KAAK;MACbC,mBAAmB,EAAE,IAAI;MACzBC,IAAI,EAAE;;GAET;IAED,KAAK,CAACN,SAAS,EAAEC,gBAAgB,CAAC;IAClC,IAAI,CAACM,MAAM,GAAG,CAAC;EACjB;EAEAC,iBAAiBA,CAACC,GAAoC;IACpD,IAAI,CAACC,aAAa,CAACD,GAAG,CAAC;EACzB;EACAE,iBAAiBA,CAACF,GAAoC;IACpD,IAAI,CAACC,aAAa,CAACD,GAAG,CAAC;EACzB;EAEAC,aAAaA,CAACD,GAAoC;IAChD,MAAM;MAAEG,WAAW;MAAEC,UAAU;MAAEC;IAAiB,CAAE,GAAGL,GAAG,CAACM,MAAM;IACjE,MAAM;MAAEC;IAAQ,CAAE,GAAGtB,sBAAsB,CAACmB,UAAU,EAAEC,iBAAiB,CAAC;IAE1E,MAAMG,QAAQ,GAAG,IAAI,CAACC,WAAW,CAACF,QAAQ,CAAC;IAC3C,MAAM;MAAEX,mBAAmB;MAAED,MAAM;MAAEE;IAAI,CAAE,GAAG,IAAI,CAACH,aAAa;IAEhE,MAAMgB,WAAW,GAAGP,WAAW,CAACQ,MAAM,CAAC,CAAC,CAAC;IACzC,IAAIC,QAAQ;IACZ,IAAIL,QAAQ,YAAYrB,cAAc,EAAE;MACtC0B,QAAQ,GAAGJ,QAAQ,CAACK,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;;IAG3C,MAAMC,cAAc,GAAG,IAAI,CAACC,iBAAiB,CAACR,QAAQ,CAAC;IACvD,MAAMT,MAAM,GAAGY,WAAW,GAAG,IAAI,CAACZ,MAAM;IAExC,IAAI,CAACgB,cAAc,EAAE;MACnB;;IAGF,IAAIE,IAAI,CAACC,GAAG,CAACnB,MAAM,CAAC,IAAIgB,cAAc,EAAE;MACtC,MAAMI,kBAAkB,GAAGF,IAAI,CAACG,KAAK,CAACrB,MAAM,GAAGgB,cAAc,CAAC;MAE9D1B,MAAM,CAACmB,QAAQ,EAAE;QACfa,KAAK,EAAEzB,MAAM,GAAG,CAACuB,kBAAkB,GAAGA,kBAAkB;QACxDN,QAAQ;QACRS,eAAe,EAAEzB,mBAAmB;QACpCC,IAAI,EAAEA;OACP,CAAC;MAEF,IAAI,CAACC,MAAM,GAAGA,MAAM,GAAGgB,cAAc;KACtC,MAAM;MACL,IAAI,CAAChB,MAAM,GAAGA,MAAM;;EAExB;EAEAiB,iBAAiBA,CAACR,QAAQ;IACxB,MAAM;MAAEe;IAAO,CAAE,GAAGf,QAAQ;IAC5B,MAAMgB,cAAc,GAAGhB,QAAQ,CAACiB,iBAAiB,EAAE;IAGnD,OAAOR,IAAI,CAACS,GAAG,CAAC,CAAC,EAAEH,OAAO,CAACI,YAAY,GAAGV,IAAI,CAACS,GAAG,CAACF,cAAc,EAAE,CAAC,CAAC,CAAC;EACxE;;AAGFlC,eAAe,CAACsC,QAAQ,GAAG,aAAa;AACxC,eAAetC,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}